<!DOCTYPE html>
<html>
<head>
<title>incidencias.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<div id='id_incidencias' />
<h2 id="incidencias">Incidencias</h2>
<div id='id_incidencia_no_facturar' />
<h3 id="error-no-consiguen-facturar-incyte">Error: No consiguen facturar (INCYTE)</h3>
<p>Para verificar que efectivamente, la factura que indican no ha sido facturada, debemos consultar el campo <strong>contfac</strong> en la tabla <strong>ipcabpe</strong>. Si este campo tiene un valor distinto de 0, se ha podido facturar.</p>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> contfac
  <span class="hljs-keyword">FROM</span> ipcabpe
 <span class="hljs-keyword">WHERE</span> coddiv = <span class="hljs-string">''</span>
   <span class="hljs-keyword">AND</span> codped = <span class="hljs-string">''</span>;
</div></code></pre>
<p>En caso de que el campo <strong>contfac</strong> tenga el valor 0, debemos comprobar el estado de las líneas de pedido. En caso de que una (o más) líneas tengan <strong>status</strong> igual a 100, el pedido no facturará.</p>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> contfac
  <span class="hljs-keyword">FROM</span> iplinpe
 <span class="hljs-keyword">WHERE</span> coddiv = <span class="hljs-string">''</span>
   <span class="hljs-keyword">AND</span> codped = <span class="hljs-string">''</span>
   <span class="hljs-keyword">AND</span> <span class="hljs-keyword">status</span> = <span class="hljs-number">100</span>;
</div></code></pre>
<p>Con esta última consulta SQL podremos ver qué lineas están haciendo que no se pueda facturar el pedido.</p>
<p>Generalmente los clientes utilizan el traductor <strong>frmMain.frm</strong> para facturar los pedidos, aquí podemos ver qué comprobaciones están haciendo sobre las líneas, que pueden hacer que finalicen con error.</p>
<pre class="hljs"><code><div><span class="hljs-keyword">DECLARE</span>
	v_coddiv	ipcabpe.coddiv%<span class="hljs-keyword">TYPE</span>;
	v_codped	ipcabpe.codped%TYPE;

	v_contfac	ipcabpe.contfac%TYPE;
	v_count		NUMBER;
<span class="hljs-keyword">BEGIN</span>

	<span class="hljs-comment">------------------------------------</span>
	<span class="hljs-comment">--        DATOS INCIDENCIA        --</span>
	<span class="hljs-comment">------------------------------------</span>

	v_coddiv := <span class="hljs-string">''</span>; <span class="hljs-comment">-- División</span>
	v_codped := ''; <span class="hljs-comment">-- Código de pedido</span>
	
	<span class="hljs-comment">------------------------------------</span>

	<span class="hljs-keyword">BEGIN</span>
		<span class="hljs-keyword">SELECT</span> contfac
		<span class="hljs-keyword">INTO</span> v_contfac
		<span class="hljs-keyword">FROM</span> ipcabpe
		<span class="hljs-keyword">WHERE</span> coddiv = v_coddiv
		<span class="hljs-keyword">AND</span> codped = v_codped;
	EXCEPTION
		WHEN NO_DATA_FOUND THEN
			dbms_output.put_line('No se ha encontrado el pedido indicado.');
			RETURN;
		WHEN TOO_MANY_ROWS THEN
			dbms_output.put_line('Varios pedidos encontrados.');
			RETURN;
	<span class="hljs-keyword">END</span>;

	IF v_contfac != 0 THEN
		dbms_output.put_line('El pedido ya se ha podido facturar.');
		RETURN;
	<span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;

	<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">COUNT</span>(<span class="hljs-number">1</span>)
	  <span class="hljs-keyword">INTO</span> v_count
	  <span class="hljs-keyword">FROM</span> iplinpe
	 <span class="hljs-keyword">WHERE</span> coddiv = v_coddiv
	   <span class="hljs-keyword">AND</span> codped = v_codped
	   <span class="hljs-keyword">AND</span> <span class="hljs-keyword">status</span> = <span class="hljs-number">100</span>;
	
	dbms_output.put_line('Se han encontrado ' || v_count || ' linea/s con status 100.');
	dbms_output.put_line('');
	dbms_output.put_line('<span class="hljs-keyword">SELECT</span> *<span class="hljs-string">');
	dbms_output.put_line('</span><span class="hljs-keyword">FROM</span> iplinpe<span class="hljs-string">');
	dbms_output.put_line('</span><span class="hljs-keyword">WHERE</span> coddiv = <span class="hljs-string">''' || v_coddiv || '''');
	dbms_output.put_line('</span><span class="hljs-keyword">AND</span> codped = <span class="hljs-string">''' || v_codped || '''');
	dbms_output.put_line('</span><span class="hljs-keyword">AND</span> <span class="hljs-keyword">status</span> = <span class="hljs-number">100</span>;');
<span class="hljs-keyword">END</span>;
</div></code></pre>
<p>Una vez que se han identificado las líneas con error, deberíamos recurrir al informador e indicarle lo que sucede para cada artículo (para cada una de las líneas con status 100).</p>
<p>Errores frecuentes:</p>
<ul>
<li>&quot;Este artículo no ha sido reportado&quot;</li>
<li>&quot;Las cantidades reales y reportadas no coinciden&quot;
<ul>
<li>Campos: En la línea de pedido <strong>cantaservir</strong> y <strong>cantservida</strong> deben tener el mismo valor.</li>
</ul>
</li>
</ul>
<p>Ruta de interés - Documentos Reportados</p>
<pre class="hljs"><code><div>I:\FICHEROSIP6\CLIENTES\INCYTE\ENTRADA\BAK
</div></code></pre>
<p>La consulta que hace el traductor para ver los pedidos a facturar es la siguiente:</p>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> * 
  <span class="hljs-keyword">FROM</span> ipcabpe CP 
 <span class="hljs-keyword">WHERE</span> CODDIV=<span class="hljs-string">'138'</span> 
   <span class="hljs-keyword">AND</span> <span class="hljs-keyword">STATUS</span>=<span class="hljs-number">18999</span> 
   <span class="hljs-keyword">AND</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> 
   					 <span class="hljs-keyword">FROM</span> IPLINPE LP 
					<span class="hljs-keyword">WHERE</span> LP.CODPED=CP.CODPED 
					  <span class="hljs-keyword">AND</span> LP.CODDIV=CP.CODDIV 
					  <span class="hljs-keyword">AND</span> LP.ANOPED=CP.ANOPED 
					  <span class="hljs-keyword">AND</span> LP.SEQPED=CP.SEQPED 
					  <span class="hljs-keyword">AND</span> LP.STATUS=<span class="hljs-number">100</span>);
</div></code></pre>
<div id='id_incidencia_contador_facturacion' />
<h3 id="contadores-de-facturaci%C3%B3n-para-facturas-abonos-y-rectificativas-biocon">Contadores de facturación para facturas, abonos y rectificativas (BIOCON)</h3>
<p>El objetivo de esta incidencia es configurar los contadores cuando hay un nuevo laboratorio o un nuevo cliente. Son genéricos, lo único que cambia será la división en función del cliente al que haya que configurarle los contadores. En los <strong>INSERT</strong> que se muestran a continuación, utilizamos la división <strong>604</strong>, de <strong>BIOCON</strong>.</p>
<pre class="hljs"><code><div><span class="hljs-keyword">Insert</span> <span class="hljs-keyword">into</span> T2P.XIPCONTFAC (DIVISION,NUMINI,PERIODO,SERIE,NUMACTUAL,TIPO,ABIERTO,TIPOPEDIDO,MASCARA) <span class="hljs-keyword">values</span> (<span class="hljs-string">'604'</span>,<span class="hljs-string">'1'</span>,<span class="hljs-string">'2023'</span>,<span class="hljs-string">'PP'</span>,<span class="hljs-string">'2300001'</span>,<span class="hljs-string">'F'</span>,<span class="hljs-string">'S'</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>);
<span class="hljs-keyword">Insert</span> <span class="hljs-keyword">into</span> T2P.XIPCONTFAC (DIVISION,NUMINI,PERIODO,SERIE,NUMACTUAL,TIPO,ABIERTO,TIPOPEDIDO,MASCARA) <span class="hljs-keyword">values</span> (<span class="hljs-string">'604'</span>,<span class="hljs-string">'1'</span>,<span class="hljs-string">'2023'</span>,<span class="hljs-string">'PA'</span>,<span class="hljs-string">'2390001'</span>,<span class="hljs-string">'A'</span>,<span class="hljs-string">'S'</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>);
<span class="hljs-keyword">Insert</span> <span class="hljs-keyword">into</span> T2P.XIPCONTFAC (DIVISION,NUMINI,PERIODO,SERIE,NUMACTUAL,TIPO,ABIERTO,TIPOPEDIDO,MASCARA) <span class="hljs-keyword">values</span> (<span class="hljs-string">'604'</span>,<span class="hljs-string">'1'</span>,<span class="hljs-string">'2023'</span>,<span class="hljs-string">'FI'</span>,<span class="hljs-string">'2380001'</span>,<span class="hljs-string">'R'</span>,<span class="hljs-string">'S'</span>,<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>);
</div></code></pre>
<div id='id_incidencia_generacion_carpeta' />
<h3 id="generaci%C3%B3n-de-carpetas">Generación de carpetas</h3>
<p>El objetivo de esta incidencia es generar las carpetas cuando hay un nuevo laboratorio o un nuevo cliente. Son genéricas, lo único que cambia será la división en función del cliente al que haya que generarle las carpetas.</p>
<p>Carpeta en la que se generan los pdfs para el proceso diario de envío de ZIP.</p>
<pre class="hljs"><code><div>J:\wwwroot\xls\604\FACTURAS\OUT
</div></code></pre>
<p>Para el envío y la recepción de archivos (Integración con el nuevo cliente).</p>
<pre class="hljs"><code><div>I:\IP6DATOS\INTERFASES\BIOCON
I:\IP6DATOS\INTERFASES\BIOCON\bajar
I:\IP6DATOS\INTERFASES\BIOCON\subir
I:\IP6DATOS\INTERFASES\BIOCON\errores
</div></code></pre>
<div id='id_estructura_nombre_rpt' />
<h3 id="estructura-del-nombre-de-los-reportes">Estructura del nombre de los reportes</h3>
<p>El nombre de los reportes debe seguir la siguiente estructura:</p>
<p>&quot;IPALBARAN&quot; + TIPO + CODIGO DIVISION</p>
<p>Un ejemplo de nombre de reporte podría ser: <strong>IPALBARANV160.rpt</strong></p>
<table>
	<tr>
        <th>Tipo</th>
        <th>Descripción</th>
    </tr>
	<tr>
        <td>V</td>
        <td>ALBARAN</td>
    </tr>
	<tr>
        <td>F</td>
        <td>FACTURA</td>
    </tr>
	<tr>
        <td>P</td>
        <td>PROFORMA</td>
    </tr>
</table>
<div id='id_facturas_diarias_ZIP' />
<h3 id="proceso-de-env%C3%ADo-de-facturas-diarias-zip">Proceso de envío de Facturas diarias .ZIP</h3>
<p>El proceso de generación de facturas se ha migrado a APEX.
Para incluír un nuevo proceso de creación de facturas <strong>.pdf</strong> se debe hacer en la base datos de APEX-INT en el esquema:</p>
<pre class="hljs"><code><div>APPS - Package APPS_REPORTING_PKG - PROCEDURE launch_facturacion_alloga
</div></code></pre>
<p>En nuestro caso el archivo origal era este:</p>
<pre class="hljs"><code><div>PROCEDURE launch_facturacion_alloga(p_job_id IN NUMBER,p_date IN DATE DEFAULT sysdate) IS
    l_start_date     VARCHAR2(30) := to_char(SYSDATE, 'dd/mm/yyyy hh24:mi:ss');
    l_retcode        NUMBER;
    l_errbuf         VARCHAR2(32676);
    l_step           VARCHAR2(255);
    l_error          VARCHAR2(32676);
    l_coddiv        VARCHAR2(12);
    l_date          DATE;
<span class="hljs-keyword">BEGIN</span>
 
	dbms_output.put_line(<span class="hljs-string">'l_date: '</span> || p_date);
	l_date := nvl(p_date,sysdate);
	dbms_output.put_line('l_date: ' || l_date);
	launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '122',p_date =&gt; l_date,p_prefix =&gt; 'BLF-INVOICE');
	launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '193',p_date =&gt; l_date,p_prefix =&gt; 'OUT\INVOICE');
	launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '471',p_date =&gt; l_date,p_prefix =&gt; 'OUT\INVOICE');
	launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '473',p_date =&gt; l_date,p_prefix =&gt; 'OUT\INVOICE');
	launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '474',p_date =&gt; l_date,p_prefix =&gt; 'OUT\INVOICE');
	launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '476',p_date =&gt; l_date,p_prefix =&gt; 'OUT\INVOICE');

EXCEPTION
    WHEN OTHERS THEN
        IF p_job_id &lt;&gt; -99 THEN
            apexc_scheduler.set_job_error_message(p_job_id =&gt; p_job_id,  p_message =&gt; 'An unexpected error ocurred for launch_facturacion_alloga ' || to_char(SYSDATE, 'dd/mm/yyyy hh24:mi:ss') || ' - ' || SQLCODE || ': ' || SQLERRM);
        ELSE
            RAISE;
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
<span class="hljs-keyword">END</span> launch_facturacion_alloga;
</div></code></pre>
<p>Agregamos una línea para cada nueva división, en nuestro caso las divisiones <strong>602</strong> y <strong>604</strong>.</p>
<pre class="hljs"><code><div>launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '602',p_date =&gt; l_date,p_prefix =&gt; 'OUT\INVOICE');
launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '604',p_date =&gt; l_date,p_prefix =&gt; 'OUT\INVOICE');
</div></code></pre>
<p>El archivo final quedaría como se muestra a continuación:</p>
<pre class="hljs"><code><div>PROCEDURE launch_facturacion_alloga(p_job_id IN NUMBER,p_date IN DATE DEFAULT sysdate) IS
    l_start_date     VARCHAR2(30) := to_char(SYSDATE, 'dd/mm/yyyy hh24:mi:ss');
    l_retcode        NUMBER;
    l_errbuf         VARCHAR2(32676);
    l_step           VARCHAR2(255);
    l_error          VARCHAR2(32676);
    l_coddiv        VARCHAR2(12);
    l_date          DATE;
<span class="hljs-keyword">BEGIN</span>
 
	dbms_output.put_line(<span class="hljs-string">'l_date: '</span> || p_date);
	l_date := nvl(p_date,sysdate);
	dbms_output.put_line('l_date: ' || l_date);
	launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '122',p_date =&gt; l_date,p_prefix =&gt; 'BLF-INVOICE');
	launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '193',p_date =&gt; l_date,p_prefix =&gt; 'OUT\INVOICE');
	launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '471',p_date =&gt; l_date,p_prefix =&gt; 'OUT\INVOICE');
	launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '473',p_date =&gt; l_date,p_prefix =&gt; 'OUT\INVOICE');
	launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '474',p_date =&gt; l_date,p_prefix =&gt; 'OUT\INVOICE');
	launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '476',p_date =&gt; l_date,p_prefix =&gt; 'OUT\INVOICE');

	<span class="hljs-comment">----------------------------------------------------------------------------------------------------------</span>
	<span class="hljs-comment">--                                           NUEVAS LÍNEAS                                              --</span>
	<span class="hljs-comment">----------------------------------------------------------------------------------------------------------</span>
	
	launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '602',p_date =&gt; l_date,p_prefix =&gt; 'OUT\INVOICE');
	launch_factura_division(p_job_id =&gt; p_job_id,p_coddiv =&gt; '604',p_date =&gt; l_date,p_prefix =&gt; 'OUT\INVOICE');

	<span class="hljs-comment">----------------------------------------------------------------------------------------------------------</span>
 
EXCEPTION
    WHEN OTHERS THEN
        IF p_job_id &lt;&gt; -99 THEN
            apexc_scheduler.set_job_error_message(p_job_id =&gt; p_job_id,  p_message =&gt; 'An unexpected error ocurred for launch_facturacion_alloga ' || to_char(SYSDATE, 'dd/mm/yyyy hh24:mi:ss') || ' - ' || SQLCODE || ': ' || SQLERRM);
        ELSE
            RAISE;
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
<span class="hljs-keyword">END</span> launch_facturacion_alloga;
</div></code></pre>
<div id='id_integracion_gateway' />
<h3 id="integraci%C3%B3n-gateway-karo">Integración Gateway (KARO)</h3>
<p>El cliente solicita obtener información a través de Gateway.</p>
<p>Grupos de información requeridos:</p>
<ul>
<li><a href="#id_productxr">ProductXR</a></li>
<li><a href="#id_customerxr">CustomerXR</a></li>
<li><a href="#id_po_asn_confirmation">PO &amp; ASN Confirmation</a></li>
<li><a href="#id_ship_confirmation">Ship Confirmation</a></li>
<li><a href="#id_pod">Proof Of Delivery (POD)</a></li>
<li><a href="#id_stock_transaction">Stock Transactions</a></li>
<li><a href="#id_stock_reconciliation">Stock Reconciliation</a></li>
<li><a href="#id_invoices">Invoices</a></li>
<li><a href="#id_payments">Payments (cash receipt)</a></li>
<li><a href="#id_openinvoices">OpenInvoices (aged balance)</a></li>
<li><a href="#id_wip">WIP (Work In Progreess)</a></li>
</ul>
<div id='id_productxr' />
<h4 id="productxr">ProductXR</h4>
<p>Se debe configurar el IFL I2H.INBPRODUCTXRxxx (siendo xxx la división correspondiente). Los archivos ya existen, se deben modificar para la división requerida.</p>
<p>Para KARO tomamos el IFL de la división 113 como base <strong>I2H.INBPRODUCTXR113.IFL</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
    BPOSTHIJOS=          
           <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span>  IPSERIEEXP 
           <span class="hljs-keyword">WHERE</span> CODSERIEEXP <span class="hljs-keyword">IN</span> (
           			<span class="hljs-keyword">SELECT</span> SEX.CODSERIEEXP <span class="hljs-keyword">FROM</span> IPCABPE CP, IPSERIEEXP SEX
				<span class="hljs-keyword">WHERE</span> CP.CODSERIEEXP = SEX.CODSERIEEXP <span class="hljs-keyword">AND</span> SEX.STATUS=<span class="hljs-number">15000</span> <span class="hljs-keyword">AND</span> CP.CODDIV <span class="hljs-keyword">IN</span> (<span class="hljs-string">'001'</span>)
                                      				<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> SEX.CODSERIEEXP);
 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
 
BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'INBProductXR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW 
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'113'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
 
 
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY=  <span class="hljs-keyword">SELECT</span> :USERGW A1, <span class="hljs-string">'ATNES'</span> A2, <span class="hljs-string">'ES'</span> A3,  NVL(ITEMNAME,CODARTDIV) A4,  NVL(ITEMNAME,CODARTDIV) A5, ART.DESART A6, 
			<span class="hljs-keyword">DECODE</span>(CLA.CODCLASE,<span class="hljs-string">'FRIO'</span>,<span class="hljs-string">'Refrigerated'</span>,<span class="hljs-string">'PSICOTROPO'</span>,<span class="hljs-string">'CD'</span>,<span class="hljs-string">'Ambient'</span>) A7,
			 <span class="hljs-keyword">DECODE</span>(CLA2.CODCLASE,<span class="hljs-string">'CUARENTENA'</span>,<span class="hljs-string">'QCHold'</span>,<span class="hljs-string">'Released'</span>) A8,
			  <span class="hljs-keyword">DECODE</span>(CLA3.CODCLASE,<span class="hljs-literal">NULL</span>,<span class="hljs-string">'N'</span>,<span class="hljs-string">'Y'</span>) A9,
			   (<span class="hljs-keyword">DECODE</span>(CLA3.CODCLASE,<span class="hljs-literal">NULL</span>,<span class="hljs-number">0</span>,CLA3.CODCLASE)*<span class="hljs-number">30</span>) A10,<span class="hljs-string">'N'</span> A11,<span class="hljs-string">'N'</span> A12,<span class="hljs-string">'N'</span> A13, 
			<span class="hljs-keyword">TRIM</span>(TO_CHAR(APR.PESOUNI,<span class="hljs-string">'00000000.0000'</span>))  A14, 
			<span class="hljs-keyword">TRIM</span>(TO_CHAR(APR.LARGOUNI*APR.ANCHOUNI*APR.ALTOUNI/<span class="hljs-number">1000000</span> ,<span class="hljs-string">'00000000.0000'</span>))  A15, 
			<span class="hljs-keyword">TRIM</span>(TO_CHAR(UNIPAQ,<span class="hljs-string">'00000000.0000'</span>)) A16,<span class="hljs-string">'EACH'</span> A17,<span class="hljs-string">''</span> A18, <span class="hljs-keyword">SUBSTR</span>(ART.CODEAN,<span class="hljs-number">2</span>,<span class="hljs-number">999</span>) A19,  <span class="hljs-keyword">SUBSTR</span>(ART.CODEAN,<span class="hljs-number">2</span>,<span class="hljs-number">999</span>) A20
			 <span class="hljs-keyword">FROM</span> IPARTIC ART,  IPDIVIS <span class="hljs-keyword">DIV</span>,
			  (<span class="hljs-keyword">SELECT</span> CODART, CODCLASIF, CODCLASE <span class="hljs-keyword">FROM</span> IPCLASEARTIC  <span class="hljs-keyword">WHERE</span> CODCLASIF=<span class="hljs-string">'ALMACEN'</span>) CLA,
			  (<span class="hljs-keyword">SELECT</span> CODART, CODCLASIF, CODCLASE <span class="hljs-keyword">FROM</span> IPCLASEARTIC  <span class="hljs-keyword">WHERE</span> CODCLASIF=<span class="hljs-string">'CALIDAD'</span>) CLA2,
			  (<span class="hljs-keyword">SELECT</span> CODART, CODCLASIF, CODCLASE <span class="hljs-keyword">FROM</span> IPCLASEARTIC  <span class="hljs-keyword">WHERE</span> CODCLASIF=<span class="hljs-string">'RETEST'</span>) CLA3,
			  IPARTPROPLOG APR
			 <span class="hljs-keyword">WHERE</span> ART.CODDIV=DIV.CODDIV <span class="hljs-keyword">AND</span> ART.CODART=CLA.CODART(+) <span class="hljs-keyword">AND</span> ART.CODART=CLA2.CODART(+) 
			 <span class="hljs-keyword">AND</span> ART.CODART=CLA3.CODART(+) <span class="hljs-keyword">AND</span> ART.CODART=APR.CODART(+) <span class="hljs-keyword">AND</span> ART.CODDIV=:CODDIV ;
 
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP, GWMATERIAL,GWMATERIAL);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP, GWMATERIAL,GWMATERIAL);                                               
    EPOSTQUERY 
    BPOSTHIJOS=
<span class="hljs-comment">#UPDATE XIPCABPE SET COMPICKPACK='S',CODOPEMODIF='PICKPACKSANOFI',HORAMODIF=HORASYS, FECMODIF=FECHASYS</span>
<span class="hljs-comment">#WHERE CODDIV=:CODDIV AND ANOPED=:ANOPED AND CODPED=:CODPED AND SEQPED=:SEQPED;</span>
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
</div></code></pre>
<p>En primer lugar, modificamos CODDIV (471 para KARO)</p>
<pre class="hljs"><code><div>BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'INBProductXR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW 
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'471'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
</div></code></pre>
<p>A continuación modificamos el campo A2 que corresponde al VENDOR_ID. En nuestro caso es ‘KARES’ Para KARO.</p>
<pre class="hljs"><code><div>BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY=  <span class="hljs-keyword">SELECT</span> :USERGW A1, <span class="hljs-string">'KARES'</span> A2, ...
</div></code></pre>
<p>Se debe garantizar que el Client_ID de los patrones de codificación del GATEWAY se encuentre configurado en el maestro de divisiones de IP6: <strong>IPDIVIS.USERGW</strong></p>
<p>El archivo final sería <strong>I2H.INBPRODUCTXR471.IFL</strong> y queda como se muestra a continuación:</p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
    BPOSTHIJOS=          
           <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span>  IPSERIEEXP 
           <span class="hljs-keyword">WHERE</span> CODSERIEEXP <span class="hljs-keyword">IN</span> (
           			<span class="hljs-keyword">SELECT</span> SEX.CODSERIEEXP <span class="hljs-keyword">FROM</span> IPCABPE CP, IPSERIEEXP SEX
				<span class="hljs-keyword">WHERE</span> CP.CODSERIEEXP = SEX.CODSERIEEXP <span class="hljs-keyword">AND</span> SEX.STATUS=<span class="hljs-number">15000</span> <span class="hljs-keyword">AND</span> CP.CODDIV <span class="hljs-keyword">IN</span> (<span class="hljs-string">'001'</span>)
                                      				<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> SEX.CODSERIEEXP);
 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
 
BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'UAT_INB_ES_ProductXR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW 
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'471'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
 
 
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY=  <span class="hljs-keyword">SELECT</span> :USERGW A1, <span class="hljs-string">'KARES'</span> A2, <span class="hljs-string">'ES'</span> A3,  NVL(ART.CODART,ITEMNAME) A4,  NVL(ART.CODARTDIV,ITEMNAME) A5, ART.DESART A6, 
			<span class="hljs-keyword">DECODE</span>(CLA.CODCLASE,<span class="hljs-string">'FRIO'</span>,<span class="hljs-string">'Refrigerated'</span>,<span class="hljs-string">'PSICOTROPO'</span>,<span class="hljs-string">'CD'</span>,<span class="hljs-string">'Ambient'</span>) A7,
			 <span class="hljs-keyword">DECODE</span>(CLA2.CODCLASE,<span class="hljs-string">'CUARENTENA'</span>,<span class="hljs-string">'QCHold'</span>,<span class="hljs-string">'Released'</span>) A8,
			  <span class="hljs-keyword">DECODE</span>(CLA3.CODCLASE,<span class="hljs-literal">NULL</span>,<span class="hljs-string">'N'</span>,<span class="hljs-string">'Y'</span>) A9,
			   (<span class="hljs-keyword">DECODE</span>(CLA3.CODCLASE,<span class="hljs-literal">NULL</span>,<span class="hljs-number">0</span>,CLA3.CODCLASE)*<span class="hljs-number">30</span>) A10,<span class="hljs-string">'N'</span> A11,<span class="hljs-string">'N'</span> A12,<span class="hljs-string">'N'</span> A13, 
			<span class="hljs-keyword">TRIM</span>(TO_CHAR(APR.PESOUNI,<span class="hljs-string">'00000000.0000'</span>))  A14, 
			<span class="hljs-keyword">TRIM</span>(TO_CHAR(APR.LARGOUNI*APR.ANCHOUNI*APR.ALTOUNI/<span class="hljs-number">1000000</span> ,<span class="hljs-string">'00000000.0000'</span>))  A15, 
			<span class="hljs-keyword">TRIM</span>(TO_CHAR(UNIPAQ,<span class="hljs-string">'00000000.0000'</span>)) A16,<span class="hljs-string">'EACH'</span> A17,<span class="hljs-string">''</span> A18, <span class="hljs-keyword">SUBSTR</span>(ART.CODEAN,<span class="hljs-number">2</span>,<span class="hljs-number">999</span>) A19,  <span class="hljs-keyword">SUBSTR</span>(ART.CODEAN,<span class="hljs-number">2</span>,<span class="hljs-number">999</span>) A20
			 <span class="hljs-keyword">FROM</span> IPARTIC ART,  IPDIVIS <span class="hljs-keyword">DIV</span>,
			  (<span class="hljs-keyword">SELECT</span> CODART, CODCLASIF, CODCLASE <span class="hljs-keyword">FROM</span> IPCLASEARTIC  <span class="hljs-keyword">WHERE</span> CODCLASIF=<span class="hljs-string">'ALMACEN'</span>) CLA,
			  (<span class="hljs-keyword">SELECT</span> CODART, CODCLASIF, CODCLASE <span class="hljs-keyword">FROM</span> IPCLASEARTIC  <span class="hljs-keyword">WHERE</span> CODCLASIF=<span class="hljs-string">'CALIDAD'</span>) CLA2,
			  (<span class="hljs-keyword">SELECT</span> CODART, CODCLASIF, CODCLASE <span class="hljs-keyword">FROM</span> IPCLASEARTIC  <span class="hljs-keyword">WHERE</span> CODCLASIF=<span class="hljs-string">'RETEST'</span>) CLA3,
			  IPARTPROPLOG APR
			 <span class="hljs-keyword">WHERE</span> ART.CODDIV=DIV.CODDIV <span class="hljs-keyword">AND</span> ART.CODART=CLA.CODART(+) <span class="hljs-keyword">AND</span> ART.CODART=CLA2.CODART(+) 
			 <span class="hljs-keyword">AND</span> ART.CODART=CLA3.CODART(+) <span class="hljs-keyword">AND</span> ART.CODART=APR.CODART(+) <span class="hljs-keyword">AND</span> ART.CODDIV=:CODDIV ;
 
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP, GWMATERIAL,GWMATERIAL);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP, GWMATERIAL,GWMATERIAL);                                               
    EPOSTQUERY 
    BPOSTHIJOS=
<span class="hljs-comment">#UPDATE XIPCABPE SET COMPICKPACK='S',CODOPEMODIF='PICKPACKSANOFI',HORAMODIF=HORASYS, FECMODIF=FECHASYS</span>
<span class="hljs-comment">#WHERE CODDIV=:CODDIV AND ANOPED=:ANOPED AND CODPED=:CODPED AND SEQPED=:SEQPED;</span>
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
</div></code></pre>
<h4 id="customerxr">CustomerXR</h4>
<p>Se debe configurar el IFL I2H.INBCUSTOMERXRxxx.IFL (siendo xxx la división correspondiente). Los archivos ya existen se deben modificar para la división requerida.</p>
<p>Para KARO tomamos el IFL de la división 113 como base <strong>I2H.INBCUSTOMERXR113.IFL</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
    BPOSTHIJOS=          
           <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span>  IPSERIEEXP ;
 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
 
BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'INBCustomerXR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW,CODDIV
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'113'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
 
 
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> :USERGW A1,  <span class="hljs-string">'ES'</span> A2, NVL(XDE.CODCLIREEXP,XDE.CODCLI)  A3, <span class="hljs-string">''</span> A4,NVL(XDE.CODCLIREEXP,XDE.CODCLI) A5, <span class="hljs-string">''</span> A6, XDE.DESCLI A7, <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(XDE.DIRECCION,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) A8, 
        <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(XDE.DIRECCION,<span class="hljs-number">36</span>,<span class="hljs-number">5</span>)|| <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(XDE.DIRECCION1,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) ) A9, 
        XDE.POBLACION A10,<span class="hljs-string">'ESPAÑA'</span> A11, XDE.DP A12 , (<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> NIFREEXP <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> (<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> XDE.NIF <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">''</span> <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(XDE.NIF,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)=<span class="hljs-string">'ES'</span> <span class="hljs-keyword">THEN</span> XDE.NIF <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'ES'</span>||XDE.NIF <span class="hljs-keyword">END</span>) <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(NIFREEXP,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)=<span class="hljs-string">'ES'</span> <span class="hljs-keyword">THEN</span> NIFREEXP  <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'ES'</span>||NIFREEXP <span class="hljs-keyword">END</span>)   A13, <span class="hljs-string">'NO APLICA'</span> A14, <span class="hljs-string">'Y'</span> A24, XDE.CODCLI, XDE.CODDIV
        <span class="hljs-keyword">FROM</span> IPCABPE XDE,  IPDIVIS <span class="hljs-keyword">DIV</span> , xipdestinatarios DES <span class="hljs-keyword">WHERE</span> XDE.CODDIV=DIV.CODDIV  <span class="hljs-keyword">AND</span> XDE.CODDIV=:CODDIV <span class="hljs-keyword">AND</span> DES.CODCLI=XDE.CODCLI <span class="hljs-keyword">AND</span> DES.CODDIV=XDE.CODDIV 
        <span class="hljs-keyword">AND</span> DES.COMUNICADO <span class="hljs-keyword">IN</span>  (<span class="hljs-number">0</span>,<span class="hljs-number">1</span>) <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>  <span class="hljs-string">'ES'</span> , XDE.CODCLIREEXP  , XDE.CODCLIREEXP , XDE.DESCLI , <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(XDE.DIRECCION,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) , 
        <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(XDE.DIRECCION,<span class="hljs-number">36</span>,<span class="hljs-number">5</span>)|| <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(XDE.DIRECCION1,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) ) , 
        XDE.POBLACION , XDE.DP  , (<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> NIFREEXP <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> (<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> XDE.NIF <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">''</span> <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(XDE.NIF,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)=<span class="hljs-string">'ES'</span> 
        <span class="hljs-keyword">THEN</span> XDE.NIF <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'ES'</span>||XDE.NIF <span class="hljs-keyword">END</span>) <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(NIFREEXP,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)=<span class="hljs-string">'ES'</span> <span class="hljs-keyword">THEN</span> NIFREEXP  <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'ES'</span>||NIFREEXP <span class="hljs-keyword">END</span>)   , XDE.CODCLI, XDE.CODDIV;
 
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP, GWCUSTOMER,GWCUSTOMER);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP, GWCUSTOMER,GWCUSTOMER);                                               
    EPOSTQUERY 
    BPOSTHIJOS=
       <span class="hljs-keyword">UPDATE</span> XIPDESTINATARIOS <span class="hljs-keyword">SET</span> COMUNICADO=<span class="hljs-number">1</span> <span class="hljs-keyword">WHERE</span> CODDIV=:CODDIV <span class="hljs-keyword">AND</span> CODCLI=:CODCLI;
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
</div></code></pre>
<p>Modificamos CODDIV (471 para KARO)</p>
<pre class="hljs"><code><div>BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'INBCustomerXR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW,CODDIV
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'471'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
</div></code></pre>
<p>Se debe garantizar que el Client_ID de los patrones de codificación del GATEWAY se encuentre configurado en el maestro de divisiones de IP6: <strong>IPDIVIS.USERGW</strong></p>
<p>El archivo final sería <strong>I2H.INBCUSTOMERXR471.IFL</strong> y queda como se muestra a continuación:</p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
    BPOSTHIJOS=          
           <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span>  IPSERIEEXP ;
 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
 
BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'UAT_INB_ES_CustomerXR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW,CODDIV
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'471'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
 
 
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> :USERGW A1,  <span class="hljs-string">'ES'</span> A2, XDE.CODCLI  A3, <span class="hljs-string">''</span> A4,NVL(XDE.CODCLIREEXP,XDE.CODCLI) A5, <span class="hljs-string">''</span> A6, XDE.DESCLI A7, <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(XDE.DIRECCION,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) A8, 
        <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(XDE.DIRECCION,<span class="hljs-number">36</span>,<span class="hljs-number">5</span>)|| <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(XDE.DIRECCION1,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) ) A9, 
        XDE.POBLACION A10,<span class="hljs-string">'ESPAÑA'</span> A11, XDE.DP A12 , (<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> NIFREEXP <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> (<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> XDE.NIF <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">''</span> <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(XDE.NIF,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)=<span class="hljs-string">'ES'</span> <span class="hljs-keyword">THEN</span> XDE.NIF <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'ES'</span>||XDE.NIF <span class="hljs-keyword">END</span>) <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(NIFREEXP,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)=<span class="hljs-string">'ES'</span> <span class="hljs-keyword">THEN</span> NIFREEXP  <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'ES'</span>||NIFREEXP <span class="hljs-keyword">END</span>)   A13, <span class="hljs-string">'NO APLICA'</span> A14, <span class="hljs-string">'Y'</span> A24, XDE.CODCLI, XDE.CODDIV
        <span class="hljs-keyword">FROM</span> IPCABPE XDE,  IPDIVIS <span class="hljs-keyword">DIV</span> , xipdestinatarios DES <span class="hljs-keyword">WHERE</span> XDE.CODDIV=DIV.CODDIV  <span class="hljs-keyword">AND</span> XDE.CODDIV=:CODDIV <span class="hljs-keyword">AND</span> DES.CODCLI=XDE.CODCLI <span class="hljs-keyword">AND</span> DES.CODDIV=XDE.CODDIV 
        <span class="hljs-keyword">AND</span> DES.COMUNICADO <span class="hljs-keyword">IN</span>  (<span class="hljs-number">0</span>,<span class="hljs-number">1</span>) <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>  <span class="hljs-string">'ES'</span> , XDE.CODCLIREEXP  , XDE.CODCLIREEXP , XDE.DESCLI , <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(XDE.DIRECCION,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) , 
        <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(XDE.DIRECCION,<span class="hljs-number">36</span>,<span class="hljs-number">5</span>)|| <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(XDE.DIRECCION1,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) ) , 
        XDE.POBLACION , XDE.DP  , (<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> NIFREEXP <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> (<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> XDE.NIF <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">''</span> <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(XDE.NIF,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)=<span class="hljs-string">'ES'</span> 
        <span class="hljs-keyword">THEN</span> XDE.NIF <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'ES'</span>||XDE.NIF <span class="hljs-keyword">END</span>) <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(NIFREEXP,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)=<span class="hljs-string">'ES'</span> <span class="hljs-keyword">THEN</span> NIFREEXP  <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'ES'</span>||NIFREEXP <span class="hljs-keyword">END</span>)   , XDE.CODCLI, XDE.CODDIV;
 
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP, GWCUSTOMER,GWCUSTOMER);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP, GWCUSTOMER,GWCUSTOMER);                                               
    EPOSTQUERY 
    BPOSTHIJOS=
       <span class="hljs-keyword">UPDATE</span> XIPDESTINATARIOS <span class="hljs-keyword">SET</span> COMUNICADO=<span class="hljs-number">1</span> <span class="hljs-keyword">WHERE</span> CODDIV=:CODDIV <span class="hljs-keyword">AND</span> CODCLI=:CODCLI;
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
</div></code></pre>
<div id='id_po_asn_confirmation' />
<h4 id="po--asn-confirmation">PO &amp; ASN Confirmation</h4>
<p>--</p>
<div id='id_ship_confirmation' />
<h4 id="ship-confirmation">Ship Confirmation</h4>
<p>Se debe configurar el IFL I2H.INBTRANSACTIONXXX (siendo xxx la división correspondiente). Los archivos ya existen se deben modificar para la división requerida.</p>
<p>Para KARO tomamos el IFL de la división 198 como base: <strong>I2H.INBTRANSACTION198.ifl</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
    BPOSTHIJOS=          
<span class="hljs-comment">#          UPDATE IPSERIEEXP SET status=20000,CODOPEMODIF='CABLINEXP001',HORAMODIF=HORASYS,FECMODIF=FECHASYS  </span>
           <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
 
BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'INBTransaction'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW, CODDIV 
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span>  DIV.CODDIV <span class="hljs-keyword">IN</span> (<span class="hljs-string">'198'</span>);
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
 
 
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> USERGW A1, <span class="hljs-string">'KKNEES'</span> A2, <span class="hljs-string">'ES'</span> A3,   CODARTDIV A4,   CODARTDIV A5, 
           CP.CODDIV||<span class="hljs-string">'-'</span>||CP. CODPED||<span class="hljs-string">'-'</span>||CP. ANOPED||<span class="hljs-string">'-'</span>||CP.SEQPED||<span class="hljs-string">'-'</span>||<span class="hljs-keyword">trim</span>(TO_CHAR(LP.SEQLINORIG,<span class="hljs-string">'0000000000'</span>)) A6, 
           LP.CODLOT A7, CADUCI A8, <span class="hljs-keyword">LPAD</span>(<span class="hljs-keyword">sum</span>(CANTSERVIDA),<span class="hljs-number">8</span>,<span class="hljs-number">0</span>)||<span class="hljs-string">'.0000'</span> A9,<span class="hljs-string">'EACH'</span> A10, <span class="hljs-keyword">decode</span>(<span class="hljs-keyword">UPPER</span>(CP.TIPOPED),<span class="hljs-string">'RETURN'</span>,<span class="hljs-string">'RECRET'</span>,<span class="hljs-string">'Shipment'</span>) A11, 
           <span class="hljs-string">''</span> A12, <span class="hljs-string">''</span> A13,<span class="hljs-string">''</span> A14, <span class="hljs-string">'-'</span> A15, <span class="hljs-string">'UNIDADES EXPEDIDAS EN PEDIDO, SALIDA STOCK'</span> A16, CP.CODALB A17, TO_CHAR(LP.SEQLINORIG)  A18, 
           CP.CODPED A19, TO_CHAR(LP.SEQLINORIG) A20, TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECTERMIN,<span class="hljs-string">'J'</span>),<span class="hljs-string">'YYYYMMDD'</span>) A21,
           (<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> cp.codareaexped <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%09%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'CANARY'</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'BOROX'</span> <span class="hljs-keyword">END</span>) A39, 
           CP.CODDIV,CP. CODPED,CP. ANOPED,CP.SEQPED 
           <span class="hljs-keyword">FROM</span> IPCABPE CP, IPLINPE LP, 
           IPARTIC ART, IPAGENC AGE, IPDIVIS <span class="hljs-keyword">DIV</span> 
           <span class="hljs-keyword">WHERE</span> CP.CODDIV <span class="hljs-keyword">in</span> (<span class="hljs-string">'198'</span>) <span class="hljs-keyword">AND</span> CP.CODPED=LP.CODPED <span class="hljs-keyword">AND</span> CP.ANOPED=LP.ANOPED <span class="hljs-keyword">AND</span> CP.SEQPED= LP.SEQPED <span class="hljs-keyword">AND</span> CP.CODDIV=LP.CODDIV  
           <span class="hljs-keyword">AND</span> CP.CODDIV=DIV.CODDIV 
           <span class="hljs-keyword">AND</span> ART.CODART=LP.CODART 
           <span class="hljs-keyword">AND</span> LP.STATUS+<span class="hljs-number">0</span>&lt;&gt; (<span class="hljs-number">2000</span>)
           <span class="hljs-keyword">AND</span> LP.CANTSERVIDA+<span class="hljs-number">0</span>&lt;&gt;<span class="hljs-number">0</span> <span class="hljs-keyword">AND</span> CP.CODAGE=AGE.CODAGE  <span class="hljs-keyword">AND</span> FECDEVUELTO+<span class="hljs-number">0</span>=<span class="hljs-number">0</span> 
           <span class="hljs-keyword">AND</span> CP.STATUS+<span class="hljs-number">0</span> <span class="hljs-keyword">between</span> <span class="hljs-number">11500</span> <span class="hljs-keyword">and</span> <span class="hljs-number">29999</span> <span class="hljs-keyword">AND</span> <span class="hljs-keyword">SUBSTR</span>(CP.CODPED,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)&lt;&gt;<span class="hljs-string">'AG'</span>    <span class="hljs-keyword">AND</span> CP.FECRECEP&gt;=to_char(<span class="hljs-keyword">to_date</span>(<span class="hljs-string">'17/10/2022'</span>),<span class="hljs-string">'j'</span>)
           <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> DIV.DABDIV, CP.CODDIV,  CODARTDIV,  CODARTDIV,   CP.CODDIV||<span class="hljs-string">'-'</span>||CP. CODPED||<span class="hljs-string">'-'</span>||CP. ANOPED||<span class="hljs-string">'-'</span>||CP.SEQPED, CP.FECTERMIN,
           LP.CODLOT, CADUCI,CP.CODPED, LP.SEQLINEA, CP.CODALB,LP.SEQLINORIG, <span class="hljs-keyword">SYSDATE</span>,CP.CODDIV,CP. CODPED,CP. ANOPED,CP.SEQPED,art.codartdiv,
           cp.codareaexped,CP.TIPOPED,USERGW ;
 
    BPOSTQUERY= 	
           ESCRIBEFICHERO(:BUZON,:FICCEXP, GWTRANSC,GWTRANSC);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP, GWTRANSC,GWTRANSC);                                               
    EPOSTQUERY 
    BPOSTHIJOS=
           <span class="hljs-keyword">UPDATE</span> IPCABPE <span class="hljs-keyword">SET</span> <span class="hljs-keyword">STATUS</span>=<span class="hljs-number">20000</span>,FECDEVUELTO=FECHASYS, HORADEVUELTO=HORASYS , CODOPEMODIF=<span class="hljs-string">'CABLINEXP'</span>,HORAMODIF=HORASYS, FECMODIF=FECHASYS
            <span class="hljs-keyword">WHERE</span> CODDIV=:CODDIV <span class="hljs-keyword">AND</span> ANOPED=:ANOPED <span class="hljs-keyword">AND</span> CODPED=:CODPED <span class="hljs-keyword">AND</span> SEQPED=:SEQPED <span class="hljs-keyword">AND</span> <span class="hljs-keyword">STATUS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-number">1</span>);
	   <span class="hljs-keyword">COMMIT</span>;
   EPOSTHIJOS
ENDBLOQUE
</div></code></pre>
<p>En primer lugar, modificamos CODDIV (471 para KARO)</p>
<pre class="hljs"><code><div>BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'INBTransaction'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW, CODDIV 
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span>  DIV.CODDIV <span class="hljs-keyword">IN</span> (<span class="hljs-string">'471'</span>);
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
</div></code></pre>
<p>A continuación modificamos el campo A2 que corresponde al VENDOR_ID. En nuestro caso es ‘KARES’ Para KARO. Y modifcamos el código de división en la WHERE.</p>
<pre class="hljs"><code><div>BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> USERGW A1, <span class="hljs-string">'‘KARES’'</span> A2, 
				  ...
			 <span class="hljs-keyword">FROM</span> IPCABPE CP, IPLINPE LP, 
        		  IPARTIC ART, IPAGENC AGE, IPDIVIS <span class="hljs-keyword">DIV</span> 
            <span class="hljs-keyword">WHERE</span> CP.CODDIV <span class="hljs-keyword">in</span> (<span class="hljs-string">'471'</span>)
</div></code></pre>
<p>Se debe garantizar que el Client_ID de los patrones de codificación del GATEWAY se encuentre configurado en el maestro de divisiones de IP6: <strong>IPDIVIS.USERGW</strong></p>
<p>El archivo final sería  <strong>I2H.INBTRANSACTION471.ifl</strong> y queda como se muestra a continuación:</p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
    BPOSTHIJOS=          
<span class="hljs-comment">#          UPDATE IPSERIEEXP SET status=20000,CODOPEMODIF='CABLINEXP001',HORAMODIF=HORASYS,FECMODIF=FECHASYS  </span>
           <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
 
BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'UAT_INB_ES_Transaction'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW, CODDIV 
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span>  DIV.CODDIV <span class="hljs-keyword">IN</span> (<span class="hljs-string">'471'</span>);
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
 
 
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> USERGW A1, <span class="hljs-string">'KARES'</span> A2, <span class="hljs-string">'ES'</span> A3,   CODARTDIV A4,   CODARTDIV A5, 
           CP.CODDIV||<span class="hljs-string">'-'</span>||CP. CODPED||<span class="hljs-string">'-'</span>||CP. ANOPED||<span class="hljs-string">'-'</span>||CP.SEQPED||<span class="hljs-string">'-'</span>||<span class="hljs-keyword">trim</span>(TO_CHAR(LP.SEQLINORIG,<span class="hljs-string">'0000000000'</span>)) A6, 
           LP.CODLOT A7, CADUCI A8, <span class="hljs-keyword">LPAD</span>(<span class="hljs-keyword">sum</span>(CANTSERVIDA),<span class="hljs-number">8</span>,<span class="hljs-number">0</span>)||<span class="hljs-string">'.0000'</span> A9,<span class="hljs-string">'EACH'</span> A10, <span class="hljs-keyword">decode</span>(<span class="hljs-keyword">UPPER</span>(CP.TIPOPED),<span class="hljs-string">'RETURN'</span>,<span class="hljs-string">'RECRET'</span>,<span class="hljs-string">'Shipment'</span>) A11, 
           <span class="hljs-string">''</span> A12, <span class="hljs-string">''</span> A13,<span class="hljs-string">''</span> A14, <span class="hljs-string">'-'</span> A15, <span class="hljs-string">'UNIDADES EXPEDIDAS EN PEDIDO, SALIDA STOCK'</span> A16, CP.CODALB A17, TO_CHAR(LP.SEQLINORIG)  A18, 
           CP.CODPED A19, TO_CHAR(LP.SEQLINORIG) A20, TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECTERMIN,<span class="hljs-string">'J'</span>),<span class="hljs-string">'YYYYMMDD'</span>) A21,
           (<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> cp.codareaexped <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%09%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'CANARY'</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'BOROX'</span> <span class="hljs-keyword">END</span>) A39, 
           CP.CODDIV,CP. CODPED,CP. ANOPED,CP.SEQPED 
           <span class="hljs-keyword">FROM</span> IPCABPE CP, IPLINPE LP, 
           IPARTIC ART, IPAGENC AGE, IPDIVIS <span class="hljs-keyword">DIV</span> 
           <span class="hljs-keyword">WHERE</span> CP.CODDIV <span class="hljs-keyword">in</span> (<span class="hljs-string">'471'</span>) <span class="hljs-keyword">AND</span> CP.CODPED=LP.CODPED <span class="hljs-keyword">AND</span> CP.ANOPED=LP.ANOPED <span class="hljs-keyword">AND</span> CP.SEQPED= LP.SEQPED <span class="hljs-keyword">AND</span> CP.CODDIV=LP.CODDIV  
           <span class="hljs-keyword">AND</span> CP.CODDIV=DIV.CODDIV 
           <span class="hljs-keyword">AND</span> ART.CODART=LP.CODART 
           <span class="hljs-keyword">AND</span> LP.STATUS+<span class="hljs-number">0</span>&lt;&gt; (<span class="hljs-number">2000</span>)
           <span class="hljs-keyword">AND</span> LP.CANTSERVIDA+<span class="hljs-number">0</span>&lt;&gt;<span class="hljs-number">0</span> <span class="hljs-keyword">AND</span> CP.CODAGE=AGE.CODAGE  <span class="hljs-keyword">AND</span> FECDEVUELTO+<span class="hljs-number">0</span>=<span class="hljs-number">0</span> 
           <span class="hljs-keyword">AND</span> CP.STATUS+<span class="hljs-number">0</span> <span class="hljs-keyword">between</span> <span class="hljs-number">11500</span> <span class="hljs-keyword">and</span> <span class="hljs-number">29999</span> <span class="hljs-keyword">AND</span> <span class="hljs-keyword">SUBSTR</span>(CP.CODPED,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)&lt;&gt;<span class="hljs-string">'AG'</span>    <span class="hljs-keyword">AND</span> CP.FECRECEP&gt;=to_char(<span class="hljs-keyword">to_date</span>(<span class="hljs-string">'17/10/2022'</span>),<span class="hljs-string">'j'</span>)
           <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> DIV.DABDIV, CP.CODDIV,  CODARTDIV,  CODARTDIV,   CP.CODDIV||<span class="hljs-string">'-'</span>||CP. CODPED||<span class="hljs-string">'-'</span>||CP. ANOPED||<span class="hljs-string">'-'</span>||CP.SEQPED, CP.FECTERMIN,
           LP.CODLOT, CADUCI,CP.CODPED, LP.SEQLINEA, CP.CODALB,LP.SEQLINORIG, <span class="hljs-keyword">SYSDATE</span>,CP.CODDIV,CP. CODPED,CP. ANOPED,CP.SEQPED,art.codartdiv,
           cp.codareaexped,CP.TIPOPED,USERGW ;
 
    BPOSTQUERY= 	
           ESCRIBEFICHERO(:BUZON,:FICCEXP, GWTRANSC,GWTRANSC);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP, GWTRANSC,GWTRANSC);                                               
    EPOSTQUERY 
    BPOSTHIJOS=
           <span class="hljs-keyword">UPDATE</span> IPCABPE <span class="hljs-keyword">SET</span> <span class="hljs-keyword">STATUS</span>=<span class="hljs-number">20000</span>,FECDEVUELTO=FECHASYS, HORADEVUELTO=HORASYS , CODOPEMODIF=<span class="hljs-string">'CABLINEXP'</span>,HORAMODIF=HORASYS, FECMODIF=FECHASYS
            <span class="hljs-keyword">WHERE</span> CODDIV=:CODDIV <span class="hljs-keyword">AND</span> ANOPED=:ANOPED <span class="hljs-keyword">AND</span> CODPED=:CODPED <span class="hljs-keyword">AND</span> SEQPED=:SEQPED <span class="hljs-keyword">AND</span> <span class="hljs-keyword">STATUS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-number">1</span>);
	   <span class="hljs-keyword">COMMIT</span>;
   EPOSTHIJOS
ENDBLOQUE
</div></code></pre>
<div id='id_pod' />
<h4 id="proof-of-delivery-pod">Proof Of Delivery (POD)</h4>
<p>Se debe configurar el IFL I2H.GWPOD.ifl. Los archivos ya existen se deben modificar para la división requerida.</p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=DIVISION
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'UAT_INB_ES_POD-'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
				 USERGW,CODDIV 
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'151'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> <span class="hljs-string">'"'</span>||A1||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A2||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A3||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A4||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A5||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A6||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A7||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A8||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A9||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A10||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A11||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A12||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A13||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A14||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A15||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A16||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A17||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A18||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A19||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A20||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A21||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A22||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A23||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A24||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A25||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A26||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A27||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A28||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A29||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A30||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A31||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A32||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A33||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A34||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A35||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A36||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A37||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A38||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A39||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A40||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A41||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A42||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A43||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A44||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A45||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A46||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A47||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A48||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A49||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A50||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A51||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A52||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A53||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A54||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A55||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A56||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A57||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A58||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A59||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A60||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A61||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A62||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A63||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A64||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A65||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A66||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A67||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A68||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A69||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A70||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A71||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A72||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A73||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A74||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A75||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A76||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A77||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A78||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A79||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A80||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A81||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A82||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A83||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A84||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A85||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A86||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A87||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A88||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A89||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A90||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A91||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A92||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A93||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A94||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A95||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A96||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A97||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A98||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A99||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A100||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A101||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A102||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A103||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A104||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A105||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A106||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A107||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A108||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A109||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A110||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A111||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A112||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A113||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A114||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A115||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A116||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A117||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A118||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A119||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A120||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A121||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A122||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A123||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A124||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A125||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A126||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A127||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A128||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A129||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A130||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A131||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A132||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A133||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A134||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A135||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A136||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A137||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A138||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A139||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A140||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A141||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A142||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A143||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A144||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A145||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A146||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A147||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>|| A148||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A149||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A150||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A151||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A152||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A153||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A154||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A155||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A156 VALOR <span class="hljs-keyword">FROM</span> ( 
<span class="hljs-keyword">SELECT</span> :USERGW A1, CP.CODDIV A2, <span class="hljs-string">'ES'</span> A3, CP.CODPED A4, CP.CODALB A5, <span class="hljs-string">''</span> A6, <span class="hljs-keyword">DECODE</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,CP.CODPED,XCP.SEQDHL) A7, AG.DESAGE A8, <span class="hljs-string">'ES'</span> A9, AGD.CODCLIAGE A10, CP.CODCLI A11, CP.DESCLI A12,
             CP.DIRECCION A13, CP.DIRECCION1 A14, CP.DIRECCION2 A15, CP.PAIS A16, CP.CODPROV A17, CP.TELEFONO A18, <span class="hljs-string">''</span> A19, <span class="hljs-string">'1900'</span> A20, 
             <span class="hljs-keyword">decode</span>(cp.fecservicio,<span class="hljs-number">0</span>,TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECRECEP+<span class="hljs-number">2</span>,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>),TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECSERVICIO,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>)) A21, 
             TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECSALIDA,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>) A22,<span class="hljs-keyword">decode</span>(cp.fecservicio,<span class="hljs-number">0</span>,TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECRECEP+<span class="hljs-number">2</span>,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>),TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECSERVICIO,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>)) A23, <span class="hljs-keyword">SUBSTR</span>(<span class="hljs-keyword">REPLACE</span>(CP.HORASALIDA,<span class="hljs-string">':'</span>,<span class="hljs-string">''</span>),<span class="hljs-number">1</span>,<span class="hljs-number">4</span>) A24, <span class="hljs-string">'NYYYYYN'</span> A25, <span class="hljs-string">'1000'</span> A26, <span class="hljs-string">'2000'</span> A27, <span class="hljs-string">'ACTIVE'</span> A28, <span class="hljs-keyword">CEIL</span>(CP.PESOPEDIDO/<span class="hljs-number">1000</span>) A29,
              <span class="hljs-string">'0'</span> A30, <span class="hljs-string">'0'</span> A31, <span class="hljs-string">'Y'</span> A32, <span class="hljs-string">'N'</span> A33, <span class="hljs-string">'N'</span> A34, <span class="hljs-string">'N'</span> A35, <span class="hljs-string">''</span> A36, DAMEBULTOSPED(CP.CODPED,CP.CODDIV,CP.ANOPED,CP.SEQPED) A37, <span class="hljs-string">'0'</span> A38, CP.CONTACTO A39, 
              DAMELINKWEBTTE(CP.CODPED,CP.CODDIV,CP.ANOPED,CP.SEQPED)  A40, <span class="hljs-string">''</span> A41,
               <span class="hljs-string">''</span> A42, <span class="hljs-string">''</span> A43, <span class="hljs-string">''</span> A44, <span class="hljs-string">'0'</span> A45, <span class="hljs-string">'0'</span> A46, <span class="hljs-string">''</span> A47, <span class="hljs-string">''</span> A48, <span class="hljs-string">'SHIPMENT'</span> A49, <span class="hljs-string">''</span> A50, <span class="hljs-string">''</span> A51, <span class="hljs-string">''</span> A52, <span class="hljs-string">''</span> A53, <span class="hljs-string">''</span> A54, <span class="hljs-string">''</span> A55, <span class="hljs-string">''</span> A56, <span class="hljs-string">''</span> A57, <span class="hljs-string">''</span> A58, <span class="hljs-string">''</span> A59, <span class="hljs-string">''</span> A60, <span class="hljs-string">''</span> A61,
                <span class="hljs-string">''</span> A62, <span class="hljs-string">''</span> A63, <span class="hljs-string">''</span> A64, <span class="hljs-string">''</span> A65, <span class="hljs-string">''</span> A66, <span class="hljs-string">''</span> A67, <span class="hljs-string">''</span> A68, <span class="hljs-string">''</span> A69, <span class="hljs-keyword">DECODE</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,CP.CODPED,XCP.SEQDHL) A70, CP.POBLACION A71, AGD.CODCLIAGE A72,
                 <span class="hljs-string">''</span> A73, <span class="hljs-string">''</span> A74, <span class="hljs-string">''</span> A75, <span class="hljs-keyword">CEIL</span>(CP.PESOPEDIDO/<span class="hljs-number">1000</span>) A76, SEQLINEA A77, <span class="hljs-string">''</span> A78, CODARTDIV A79, ITEMNAME A80, DESART A81, LP.CANTSERVIDA A82, LP.CANTPEDIDA A83, <span class="hljs-string">''</span> A84, <span class="hljs-string">''</span> A85, <span class="hljs-string">''</span> A86, <span class="hljs-string">''</span> A87, <span class="hljs-string">''</span> A88,
                  <span class="hljs-string">''</span> A89, <span class="hljs-string">''</span> A90, <span class="hljs-string">''</span> A91, <span class="hljs-string">''</span> A92, <span class="hljs-string">''</span> A93, <span class="hljs-string">''</span> A94, <span class="hljs-string">''</span> A95, <span class="hljs-string">''</span> A96, <span class="hljs-string">''</span> A97, <span class="hljs-string">''</span> A98, <span class="hljs-string">''</span> A99, <span class="hljs-string">''</span> A100, <span class="hljs-string">''</span> A101, <span class="hljs-string">''</span> A102, <span class="hljs-string">''</span> A103, <span class="hljs-string">''</span> A104, <span class="hljs-string">''</span> A105, <span class="hljs-string">''</span> A106,
                   <span class="hljs-string">''</span> A107, <span class="hljs-string">''</span> A108, <span class="hljs-string">''</span> A109, <span class="hljs-string">''</span> A110, <span class="hljs-string">''</span> A111, <span class="hljs-string">''</span> A112, <span class="hljs-string">''</span> A113, <span class="hljs-string">''</span> A114, <span class="hljs-string">''</span> A115, <span class="hljs-string">''</span> A116, <span class="hljs-string">''</span> A117, <span class="hljs-string">''</span> A118, <span class="hljs-string">''</span> A119, <span class="hljs-string">''</span> A120, <span class="hljs-string">''</span> A121, <span class="hljs-string">''</span> A122, <span class="hljs-string">''</span> A123, 
                   <span class="hljs-string">''</span> A124, <span class="hljs-string">''</span> A125, <span class="hljs-string">''</span> A126, <span class="hljs-string">''</span> A127, <span class="hljs-string">''</span> A128, <span class="hljs-string">''</span> A129, <span class="hljs-string">''</span> A130, <span class="hljs-string">''</span> A131, <span class="hljs-string">''</span> A132, <span class="hljs-string">''</span> A133, <span class="hljs-string">''</span> A134, <span class="hljs-string">''</span> A135, <span class="hljs-string">''</span> A136, <span class="hljs-string">''</span> A137, <span class="hljs-string">''</span> A138, <span class="hljs-string">''</span> A139, <span class="hljs-string">''</span> A140,
                    <span class="hljs-string">''</span> A141, <span class="hljs-string">''</span> A142, <span class="hljs-string">''</span> A143, <span class="hljs-string">''</span> A144, <span class="hljs-string">''</span> A145, <span class="hljs-string">''</span> A146, <span class="hljs-string">''</span> A147, <span class="hljs-string">''</span> A148, <span class="hljs-string">''</span> A149, <span class="hljs-string">''</span> A150, <span class="hljs-string">''</span> A151, <span class="hljs-string">''</span> A152, <span class="hljs-string">''</span> A153, <span class="hljs-string">''</span> A154, <span class="hljs-string">''</span> A155, <span class="hljs-string">''</span> A156,VALOR
            <span class="hljs-keyword">FROM</span>  IPCABPE CP,IPAGENC AG, IPAGDIV AGD , XIPCABPE XCP,IPPROVI PR,IPDIVIS <span class="hljs-keyword">DIV</span>,IPLINPE LP,IPARTIC ART, (<span class="hljs-keyword">SELECT</span>  VALOR <span class="hljs-keyword">FROM</span> IPLINFMTOINTERFASE 
            <span class="hljs-keyword">WHERE</span> CODTIPOINTERFASE= <span class="hljs-string">'PEDAVIZOR'</span> <span class="hljs-keyword">AND</span> CAMPO=<span class="hljs-string">'A2'</span>) VALOR    
              <span class="hljs-keyword">WHERE</span> CP.CODPROV=PR.CODPROV(+) <span class="hljs-keyword">AND</span> CP.CODPED = LP.CODPED  <span class="hljs-keyword">AND</span> CP.ANOPED = LP.ANOPED 
                <span class="hljs-keyword">AND</span> CP.SEQPED = LP.SEQPED  <span class="hljs-keyword">AND</span> CP.CODDIV = LP.CODDIV <span class="hljs-keyword">AND</span> LP.CODART=ART.CODART 
                <span class="hljs-keyword">AND</span> CP.CODDIV=DIV.CODDIV <span class="hljs-keyword">AND</span> CP.CODPED = XCP.CODPED  <span class="hljs-keyword">AND</span> CP.ANOPED = XCP.ANOPED 
                <span class="hljs-keyword">AND</span> CP.SEQPED = XCP.SEQPED  <span class="hljs-keyword">AND</span> CP.CODDIV = XCP.CODDIV  <span class="hljs-keyword">AND</span> CP.CODAGE = AG.CODAGE 
                <span class="hljs-keyword">AND</span> CP.CODAGE = AGD.CODAGE   <span class="hljs-keyword">AND</span> CP.CODDIV = AGD.CODDIV
                <span class="hljs-keyword">AND</span>  CP.FECRECEP <span class="hljs-keyword">BETWEEN</span> TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(<span class="hljs-string">'20/04/2022'</span>),<span class="hljs-string">'J'</span>) <span class="hljs-keyword">AND</span> FECHASYS <span class="hljs-keyword">AND</span> cp.coddiv=<span class="hljs-string">'151'</span> <span class="hljs-keyword">and</span>
                CP.STATUS <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-number">13000</span>,<span class="hljs-number">13500</span>,<span class="hljs-number">20500</span>) <span class="hljs-keyword">AND</span> CP.STATUS <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">120000</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">299999</span>  <span class="hljs-keyword">AND</span> FECSALIDA=FECHASYS<span class="hljs-number">-1</span> 
           <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> CP.CODPED,CP.SEQPED,CP.ANOPED,CP.CODDIV, <span class="hljs-keyword">decode</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,DAMEPEDIDOI2(CP.CODPED,XCP.SEQDHL),XCP.SEQDHL) ,
                CP.CODCLI,ITEMNAME,DESART,SEQLINEA,LP.CANTPEDIDA,LP.CANTSERVIDA,CODARTDIV,
                 AG.SERVICIO,PR.DESPROV, <span class="hljs-keyword">DECODE</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,CP.CODPED,XCP.SEQDHL),
                 AGD.CODCLIAGE, CP.CODAGE,CP.CONDENT, CP.FECSERVICIO,
                 CODALB, CONTACTO,DIV.DESDIV, AG.DESAGE ,CP.FECENTREGA,CP.PESOPEDIDO,CP.FECRECEP,CP.FECSALIDA,CP.HORASALIDA,
                 CODCLI,CP.OBSERV1 , CP.OBSERV2  , CP.OBSERV3 ,CP.CODPROV,
                 DESCLI, CP.DEVALB,  CP.DIRECCION,CP.DIRECCION1,CP.DIRECCION2, <span class="hljs-keyword">SUBSTR</span>(CP.CONTACTO,<span class="hljs-number">1</span>,<span class="hljs-number">40</span>), 
                 CP.POBLACION, CP.PAIS,
                 CP.DP,   CP.TELEFONO,   CP.NIF, PESOPEDIDO,CP.VOLPEDIDO,  <span class="hljs-keyword">SUBSTR</span>(CP.INFOCLIEXTRA,<span class="hljs-number">1</span>,<span class="hljs-number">60</span>), 
                 <span class="hljs-keyword">DECODE</span>(NVL(SWTPORTES,<span class="hljs-string">'S'</span>),<span class="hljs-string">'S'</span>,<span class="hljs-string">'P'</span>,<span class="hljs-string">'N'</span>,<span class="hljs-string">'D'</span>,SWTPORTES),PEDREC,XCP.PALETIZADO,URGENCIA, SWTPORTES,CONDPAGO,VALOR);
 
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP,  ASM2,T2P);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP,  ASM2,T2P);                                               
    EPOSTQUERY 
    BPOSTHIJOS=   
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
BEGINBLOQUE=LEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> <span class="hljs-string">'"'</span>||A1||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A2||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A3||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A4||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A5||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A6||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A7||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A8||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A9||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A10||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A11||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A12||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A13||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A14||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A15||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A16||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A17||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A18||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A19||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A20||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A21||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A22||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A23||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A24||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A25||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A26||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A27||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A28||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A29||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A30||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A31||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A32||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A33||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A34||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A35||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A36||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A37||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A38||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A39||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A40||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A41||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A42||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A43||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A44||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A45||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A46||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A47||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A48||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A49||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A50||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A51||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A52||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A53||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A54||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A55||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A56||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A57||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A58||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A59||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A60||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A61||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A62||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A63||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A64||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A65||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A66||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A67||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A68||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A69||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A70||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A71||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A72||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A73||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A74||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A75||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A76||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A77||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A78||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A79||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A80||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A81||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A82||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A83||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A84||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A85||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A86||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A87||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A88||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A89||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A90||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A91||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A92||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A93||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A94||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A95||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A96||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A97||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A98||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A99||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A100||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A101||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A102||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A103||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A104||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A105||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A106||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A107||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A108||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A109||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A110||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A111||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A112||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A113||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A114||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A115||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A116||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A117||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A118||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A119||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A120||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A121||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A122||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A123||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A124||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A125||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A126||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A127||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A128||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A129||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A130||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A131||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A132||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A133||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A134||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A135||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A136||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A137||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A138||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A139||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A140||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A141||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A142||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A143||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A144||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A145||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A146||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A147||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>|| A148||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A149||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A150||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A151||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A152||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A153||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A154||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A155||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A156 VALOR <span class="hljs-keyword">FROM</span> ( 
            <span class="hljs-keyword">SELECT</span> :USERGW A1, CP.CODDIV A2, <span class="hljs-string">'ES'</span> A3, CP.CODPED A4, CP.CODALB A5, <span class="hljs-string">''</span> A6, <span class="hljs-keyword">DECODE</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,CP.CODPED,XCP.SEQDHL) A7, AG.DESAGE A8, <span class="hljs-string">'ES'</span> A9, AGD.CODCLIAGE A10, CP.CODCLI A11, CP.DESCLI A12,
             CP.DIRECCION A13, CP.DIRECCION1 A14, CP.DIRECCION2 A15, CP.PAIS A16, CP.CODPROV A17, CP.TELEFONO A18, <span class="hljs-string">''</span> A19, <span class="hljs-string">'1900'</span> A20, 
             <span class="hljs-keyword">decode</span>(cp.fecservicio,<span class="hljs-number">0</span>,TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECRECEP+<span class="hljs-number">2</span>,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>),TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECSERVICIO,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>)) A21, 
             TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECENTREGA,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>) A22,<span class="hljs-keyword">decode</span>(cp.fecservicio,<span class="hljs-number">0</span>,TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECRECEP+<span class="hljs-number">2</span>,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>),TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECSERVICIO,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>)) A23,  <span class="hljs-keyword">SUBSTR</span>(<span class="hljs-keyword">REPLACE</span>(CP.HORAENTREGA,<span class="hljs-string">':'</span>,<span class="hljs-string">''</span>),<span class="hljs-number">1</span>,<span class="hljs-number">4</span>) A24, <span class="hljs-string">'NYYYYYN'</span> A25, <span class="hljs-string">'1000'</span> A26, <span class="hljs-string">'2000'</span> A27, <span class="hljs-string">'ACTIVE'</span> A28, <span class="hljs-keyword">CEIL</span>(CP.PESOPEDIDO/<span class="hljs-number">1000</span>) A29,
              <span class="hljs-string">'0'</span> A30, <span class="hljs-string">'0'</span> A31, <span class="hljs-string">'Y'</span> A32, <span class="hljs-string">'N'</span> A33, <span class="hljs-string">'N'</span> A34, <span class="hljs-string">'N'</span> A35, <span class="hljs-string">''</span> A36, DAMEBULTOSPED(CP.CODPED,CP.CODDIV,CP.ANOPED,CP.SEQPED) A37, <span class="hljs-string">'0'</span> A38, CP.CONTACTO A39, 
              DAMELINKWEBTTE(CP.CODPED,CP.CODDIV,CP.ANOPED,CP.SEQPED)  A40, <span class="hljs-string">''</span> A41,
               <span class="hljs-string">''</span> A42, <span class="hljs-string">''</span> A43, <span class="hljs-string">''</span> A44, <span class="hljs-string">'0'</span> A45, <span class="hljs-string">'0'</span> A46, <span class="hljs-string">''</span> A47, <span class="hljs-string">''</span> A48, <span class="hljs-string">'DELIVERED'</span> A49, <span class="hljs-string">''</span> A50, <span class="hljs-string">''</span> A51, <span class="hljs-string">''</span> A52, <span class="hljs-string">''</span> A53, <span class="hljs-string">''</span> A54, <span class="hljs-string">''</span> A55, <span class="hljs-string">''</span> A56, <span class="hljs-string">''</span> A57, <span class="hljs-string">''</span> A58, <span class="hljs-string">''</span> A59, <span class="hljs-string">''</span> A60, <span class="hljs-string">''</span> A61,
                <span class="hljs-string">''</span> A62, <span class="hljs-string">''</span> A63, <span class="hljs-string">''</span> A64, <span class="hljs-string">''</span> A65, <span class="hljs-string">''</span> A66, <span class="hljs-string">''</span> A67, <span class="hljs-string">''</span> A68, <span class="hljs-string">''</span> A69, <span class="hljs-keyword">DECODE</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,CP.CODPED,XCP.SEQDHL) A70, CP.POBLACION A71, AGD.CODCLIAGE A72,
                 <span class="hljs-string">''</span> A73, <span class="hljs-string">''</span> A74, <span class="hljs-string">''</span> A75, <span class="hljs-keyword">CEIL</span>(CP.PESOPEDIDO/<span class="hljs-number">1000</span>) A76, SEQLINEA A77, <span class="hljs-string">''</span> A78, CODARTDIV A79, ITEMNAME A80, DESART A81, LP.CANTSERVIDA A82, LP.CANTPEDIDA A83, <span class="hljs-string">''</span> A84, <span class="hljs-string">''</span> A85, <span class="hljs-string">''</span> A86, <span class="hljs-string">''</span> A87, <span class="hljs-string">''</span> A88,
                  <span class="hljs-string">''</span> A89, <span class="hljs-string">''</span> A90, <span class="hljs-string">''</span> A91, <span class="hljs-string">''</span> A92, <span class="hljs-string">''</span> A93, <span class="hljs-string">''</span> A94, <span class="hljs-string">''</span> A95, <span class="hljs-string">''</span> A96, <span class="hljs-string">''</span> A97, <span class="hljs-string">''</span> A98, <span class="hljs-string">''</span> A99, <span class="hljs-string">''</span> A100, <span class="hljs-string">''</span> A101, <span class="hljs-string">''</span> A102, <span class="hljs-string">''</span> A103, <span class="hljs-string">''</span> A104, <span class="hljs-string">''</span> A105, <span class="hljs-string">''</span> A106,
                   <span class="hljs-string">''</span> A107, <span class="hljs-string">''</span> A108, <span class="hljs-string">''</span> A109, <span class="hljs-string">''</span> A110, <span class="hljs-string">''</span> A111, <span class="hljs-string">''</span> A112, <span class="hljs-string">''</span> A113, <span class="hljs-string">''</span> A114, <span class="hljs-string">''</span> A115, <span class="hljs-string">''</span> A116, <span class="hljs-string">''</span> A117, <span class="hljs-string">''</span> A118, <span class="hljs-string">''</span> A119, <span class="hljs-string">''</span> A120, <span class="hljs-string">''</span> A121, <span class="hljs-string">''</span> A122, <span class="hljs-string">''</span> A123, 
                   <span class="hljs-string">''</span> A124, <span class="hljs-string">''</span> A125, <span class="hljs-string">''</span> A126, <span class="hljs-string">''</span> A127, <span class="hljs-string">''</span> A128, <span class="hljs-string">''</span> A129, <span class="hljs-string">''</span> A130, <span class="hljs-string">''</span> A131, <span class="hljs-string">''</span> A132, <span class="hljs-string">''</span> A133, <span class="hljs-string">''</span> A134, <span class="hljs-string">''</span> A135, <span class="hljs-string">''</span> A136, <span class="hljs-string">''</span> A137, <span class="hljs-string">''</span> A138, <span class="hljs-string">''</span> A139, <span class="hljs-string">''</span> A140,
                    <span class="hljs-string">''</span> A141, <span class="hljs-string">''</span> A142, <span class="hljs-string">''</span> A143, <span class="hljs-string">''</span> A144, <span class="hljs-string">''</span> A145, <span class="hljs-string">''</span> A146, <span class="hljs-string">''</span> A147, <span class="hljs-string">''</span> A148, <span class="hljs-string">''</span> A149, <span class="hljs-string">''</span> A150, <span class="hljs-string">''</span> A151, <span class="hljs-string">''</span> A152, <span class="hljs-string">''</span> A153, <span class="hljs-string">''</span> A154, <span class="hljs-string">''</span> A155, <span class="hljs-string">''</span> A156,VALOR
            <span class="hljs-keyword">FROM</span>  IPCABPE CP,IPAGENC AG, IPAGDIV AGD , XIPCABPE XCP,IPPROVI PR,IPDIVIS <span class="hljs-keyword">DIV</span>,IPLINPE LP,IPARTIC ART, (<span class="hljs-keyword">SELECT</span>  VALOR <span class="hljs-keyword">FROM</span> IPLINFMTOINTERFASE 
            <span class="hljs-keyword">WHERE</span> CODTIPOINTERFASE= <span class="hljs-string">'PEDAVIZOR'</span> <span class="hljs-keyword">AND</span> CAMPO=<span class="hljs-string">'A2'</span>) VALOR    
              <span class="hljs-keyword">WHERE</span> CP.CODPROV=PR.CODPROV(+) <span class="hljs-keyword">AND</span> CP.CODPED = LP.CODPED  <span class="hljs-keyword">AND</span> CP.ANOPED = LP.ANOPED 
                <span class="hljs-keyword">AND</span> CP.SEQPED = LP.SEQPED  <span class="hljs-keyword">AND</span> CP.CODDIV = LP.CODDIV <span class="hljs-keyword">AND</span> LP.CODART=ART.CODART 
                <span class="hljs-keyword">AND</span> CP.CODDIV=DIV.CODDIV <span class="hljs-keyword">AND</span> CP.CODPED = XCP.CODPED  <span class="hljs-keyword">AND</span> CP.ANOPED = XCP.ANOPED 
                <span class="hljs-keyword">AND</span> CP.SEQPED = XCP.SEQPED  <span class="hljs-keyword">AND</span> CP.CODDIV = XCP.CODDIV  <span class="hljs-keyword">AND</span> CP.CODAGE = AG.CODAGE 
                <span class="hljs-keyword">AND</span> CP.CODAGE = AGD.CODAGE   <span class="hljs-keyword">AND</span> CP.CODDIV = AGD.CODDIV
                <span class="hljs-keyword">AND</span>  CP.FECRECEP <span class="hljs-keyword">BETWEEN</span> TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(<span class="hljs-string">'20/04/2022'</span>),<span class="hljs-string">'J'</span>) <span class="hljs-keyword">AND</span> FECHASYS <span class="hljs-keyword">AND</span> cp.coddiv=<span class="hljs-string">'151'</span> <span class="hljs-keyword">and</span>
                CP.STATUS <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-number">13000</span>,<span class="hljs-number">13500</span>,<span class="hljs-number">20500</span>) <span class="hljs-keyword">AND</span> CP.STATUS <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">12000</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">29999</span> <span class="hljs-keyword">AND</span> FECENTREGA&gt;=FECHASYS<span class="hljs-number">-6</span> 
           <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> CP.CODPED,CP.SEQPED,CP.ANOPED,CP.CODDIV, <span class="hljs-keyword">decode</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,DAMEPEDIDOI2(CP.CODPED,XCP.SEQDHL),XCP.SEQDHL) ,
                CP.CODCLI,ITEMNAME,DESART,SEQLINEA,LP.CANTPEDIDA,LP.CANTSERVIDA,CODARTDIV,
                 AG.SERVICIO,PR.DESPROV, <span class="hljs-keyword">DECODE</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,CP.CODPED,XCP.SEQDHL),
                 AGD.CODCLIAGE, CP.CODAGE,CP.CONDENT, CP.FECSERVICIO,
                 CODALB, CONTACTO,DIV.DESDIV, AG.DESAGE ,CP.FECENTREGA,CP.PESOPEDIDO,CP.FECRECEP,CP.FECSALIDA,CP.HORAENTREGA,
                 CODCLI,CP.OBSERV1 , CP.OBSERV2  , CP.OBSERV3 ,CP.CODPROV,
                 DESCLI, CP.DEVALB,  CP.DIRECCION,CP.DIRECCION1,CP.DIRECCION2, <span class="hljs-keyword">SUBSTR</span>(CP.CONTACTO,<span class="hljs-number">1</span>,<span class="hljs-number">40</span>), 
                 CP.POBLACION, CP.PAIS,
                 CP.DP,   CP.TELEFONO,   CP.NIF, PESOPEDIDO,CP.VOLPEDIDO,  <span class="hljs-keyword">SUBSTR</span>(CP.INFOCLIEXTRA,<span class="hljs-number">1</span>,<span class="hljs-number">60</span>), 
                 <span class="hljs-keyword">DECODE</span>(NVL(SWTPORTES,<span class="hljs-string">'S'</span>),<span class="hljs-string">'S'</span>,<span class="hljs-string">'P'</span>,<span class="hljs-string">'N'</span>,<span class="hljs-string">'D'</span>,SWTPORTES),PEDREC,XCP.PALETIZADO,URGENCIA, SWTPORTES,CONDPAGO,VALOR);
 
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP,  ASM2,T2P);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP,  ASM2,T2P);                                               
    EPOSTQUERY 
    BPOSTHIJOS=   
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
</div></code></pre>
<p>En primer lugar, modificamos CODDIV (471 para KARO)</p>
<pre class="hljs"><code><div>BEGINBLOQUE=DIVISION
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'UAT_INB_ES_POD-'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
				 USERGW,CODDIV 
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'471'</span>;
</div></code></pre>
<p>A continuación modificamos los campos:</p>
<ul>
<li>A2: corresponde al VENDOR_ID. En nuestro caso es ‘KARES’ Para KARO.</li>
<li>A22: Cambiamos FECSALIDA por FECENTRADA.</li>
<li>A23: Ponemos la hora de entrega.</li>
<li>A24: Ponemos la hora de entrega.</li>
<li>A32: Eliminamos la 'Y'.</li>
<li>A49: Ponemos 'DELIVERED'.</li>
<li>A78: Ponemos la SEQLINORIG.</li>
<li>A80: Ponemos ART.CODART.</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-comment">---- </span>
</div></code></pre>
<pre class="hljs"><code><div>BEGINBLOQUE=LEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> <span class="hljs-string">'"'</span>||A1||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A2|| ...

            <span class="hljs-keyword">FROM</span>  IPCABPE CP,IPAGENC AG, IPAGDIV AGD , XIPCABPE XCP,IPPROVI PR,IPDIVIS <span class="hljs-keyword">DIV</span>,IPLINPE LP,IPARTIC ART, (<span class="hljs-keyword">SELECT</span>  VALOR <span class="hljs-keyword">FROM</span> IPLINFMTOINTERFASE 
            <span class="hljs-keyword">WHERE</span> CODTIPOINTERFASE= <span class="hljs-string">'PEDAVIZOR'</span> <span class="hljs-keyword">AND</span> CAMPO=<span class="hljs-string">'A2'</span>) VALOR    
              <span class="hljs-keyword">WHERE</span> CP.CODPROV=PR.CODPROV(+) <span class="hljs-keyword">AND</span> CP.CODPED = LP.CODPED  <span class="hljs-keyword">AND</span> CP.ANOPED = LP.ANOPED 
                <span class="hljs-keyword">AND</span> CP.SEQPED = LP.SEQPED  <span class="hljs-keyword">AND</span> CP.CODDIV = LP.CODDIV <span class="hljs-keyword">AND</span> LP.CODART=ART.CODART 
                <span class="hljs-keyword">AND</span> CP.CODDIV=DIV.CODDIV <span class="hljs-keyword">AND</span> CP.CODPED = XCP.CODPED  <span class="hljs-keyword">AND</span> CP.ANOPED = XCP.ANOPED 
                <span class="hljs-keyword">AND</span> CP.SEQPED = XCP.SEQPED  <span class="hljs-keyword">AND</span> CP.CODDIV = XCP.CODDIV  <span class="hljs-keyword">AND</span> CP.CODAGE = AG.CODAGE 
                <span class="hljs-keyword">AND</span> CP.CODAGE = AGD.CODAGE   <span class="hljs-keyword">AND</span> CP.CODDIV = AGD.CODDIV
                <span class="hljs-keyword">AND</span>  CP.FECRECEP <span class="hljs-keyword">BETWEEN</span> TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(<span class="hljs-string">'20/04/2022'</span>),<span class="hljs-string">'J'</span>) <span class="hljs-keyword">AND</span> FECHASYS <span class="hljs-keyword">AND</span> cp.coddiv=<span class="hljs-string">'151'</span> <span class="hljs-keyword">and</span>
                CP.STATUS <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-number">13000</span>,<span class="hljs-number">13500</span>,<span class="hljs-number">20500</span>) <span class="hljs-keyword">AND</span> CP.STATUS <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">12000</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">29999</span> <span class="hljs-keyword">AND</span> FECENTREGA&gt;=FECHASYS<span class="hljs-number">-6</span> 
           <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> CP.CODPED,CP.SEQPED,CP.ANOPED,CP.CODDIV, <span class="hljs-keyword">decode</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,DAMEPEDIDOI2(CP.CODPED,XCP.SEQDHL),XCP.SEQDHL) ,
                CP.CODCLI,ITEMNAME,DESART,SEQLINEA,LP.CANTPEDIDA,LP.CANTSERVIDA,CODARTDIV,
                 AG.SERVICIO,PR.DESPROV, <span class="hljs-keyword">DECODE</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,CP.CODPED,XCP.SEQDHL),
                 AGD.CODCLIAGE, CP.CODAGE,CP.CONDENT, CP.FECSERVICIO,
                 CODALB, CONTACTO,DIV.DESDIV, AG.DESAGE ,CP.FECENTREGA,CP.PESOPEDIDO,CP.FECRECEP,CP.FECSALIDA,CP.HORAENTREGA,
                 CODCLI,CP.OBSERV1 , CP.OBSERV2  , CP.OBSERV3 ,CP.CODPROV,
                 DESCLI, CP.DEVALB,  CP.DIRECCION,CP.DIRECCION1,CP.DIRECCION2, <span class="hljs-keyword">SUBSTR</span>(CP.CONTACTO,<span class="hljs-number">1</span>,<span class="hljs-number">40</span>), 
                 CP.POBLACION, CP.PAIS,
                 CP.DP,   CP.TELEFONO,   CP.NIF, PESOPEDIDO,CP.VOLPEDIDO,  <span class="hljs-keyword">SUBSTR</span>(CP.INFOCLIEXTRA,<span class="hljs-number">1</span>,<span class="hljs-number">60</span>), 
                 <span class="hljs-keyword">DECODE</span>(NVL(SWTPORTES,<span class="hljs-string">'S'</span>),<span class="hljs-string">'S'</span>,<span class="hljs-string">'P'</span>,<span class="hljs-string">'N'</span>,<span class="hljs-string">'D'</span>,SWTPORTES),PEDREC,XCP.PALETIZADO,URGENCIA, SWTPORTES,CONDPAGO,VALOR);
 
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP,  ASM2,T2P);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP,  ASM2,T2P);                                               
    EPOSTQUERY 
    BPOSTHIJOS=   
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
</div></code></pre>
<p><strong>I2H.GWPOD471.ifl</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=DIVISION
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'UAT_INB_ES_POD-'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
				 USERGW,CODDIV 
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'471'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> <span class="hljs-string">'"'</span>||A1||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A2||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A3||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A4||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A5||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A6||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A7||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A8||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A9||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A10||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A11||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A12||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A13||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A14||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A15||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A16||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A17||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A18||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A19||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A20||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A21||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A22||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A23||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A24||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A25||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A26||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A27||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A28||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A29||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A30||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A31||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A32||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A33||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A34||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A35||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A36||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A37||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A38||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A39||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A40||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A41||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A42||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A43||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A44||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A45||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A46||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A47||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A48||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A49||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A50||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A51||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A52||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A53||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A54||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A55||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A56||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A57||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A58||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A59||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A60||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A61||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A62||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A63||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A64||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A65||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A66||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A67||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A68||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A69||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A70||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A71||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A72||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A73||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A74||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A75||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A76||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A77||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A78||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A79||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A80||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A81||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A82||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A83||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A84||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A85||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A86||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A87||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A88||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A89||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A90||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A91||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A92||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A93||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A94||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A95||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A96||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A97||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A98||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A99||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A100||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A101||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A102||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A103||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A104||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A105||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A106||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A107||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A108||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A109||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A110||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A111||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A112||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A113||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A114||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A115||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A116||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A117||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A118||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A119||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A120||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A121||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A122||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A123||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A124||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A125||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A126||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A127||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A128||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A129||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A130||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A131||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A132||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A133||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A134||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A135||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A136||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A137||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A138||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A139||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A140||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A141||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A142||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A143||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A144||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A145||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A146||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A147||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>|| A148||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A149||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A150||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A151||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A152||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A153||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A154||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A155||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A156 VALOR <span class="hljs-keyword">FROM</span> ( 
<span class="hljs-keyword">SELECT</span> :USERGW A1, <span class="hljs-string">'KARES'</span> A2, <span class="hljs-string">'ES'</span> A3, CP.CODPED A4, CP.CODALB A5, <span class="hljs-string">''</span> A6, <span class="hljs-keyword">DECODE</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,CP.CODPED,XCP.SEQDHL) A7, AG.DESAGE A8, <span class="hljs-string">'ES'</span> A9, AGD.CODCLIAGE A10, CP.CODCLI A11, CP.DESCLI A12,
             CP.DIRECCION A13, CP.DIRECCION1 A14, CP.DIRECCION2 A15, CP.PAIS A16, CP.CODPROV A17, CP.TELEFONO A18, <span class="hljs-string">''</span> A19, <span class="hljs-string">'1900'</span> A20, 
             <span class="hljs-keyword">decode</span>(cp.fecservicio,<span class="hljs-number">0</span>,TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECRECEP+<span class="hljs-number">2</span>,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>),TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECSERVICIO,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>)) A21, 
             TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECENTREGA,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>) A22, <span class="hljs-keyword">SUBSTR</span>(<span class="hljs-keyword">REPLACE</span>(CP.HORAENTREGA,<span class="hljs-string">':'</span>,<span class="hljs-string">''</span>),<span class="hljs-number">1</span>,<span class="hljs-number">4</span>) A23,  <span class="hljs-keyword">SUBSTR</span>(<span class="hljs-keyword">REPLACE</span>(CP.HORAENTREGA,<span class="hljs-string">':'</span>,<span class="hljs-string">''</span>),<span class="hljs-number">1</span>,<span class="hljs-number">4</span>) A24, <span class="hljs-string">'NYYYYYN'</span> A25, <span class="hljs-string">'1000'</span> A26, <span class="hljs-string">'2000'</span> A27, <span class="hljs-string">'ACTIVE'</span> A28, <span class="hljs-keyword">CEIL</span>(CP.PESOPEDIDO/<span class="hljs-number">1000</span>) A29,
              <span class="hljs-string">'0'</span> A30, <span class="hljs-string">'0'</span> A31, <span class="hljs-string">''</span> A32, <span class="hljs-string">'N'</span> A33, <span class="hljs-string">'N'</span> A34, <span class="hljs-string">'N'</span> A35, <span class="hljs-string">''</span> A36, DAMEBULTOSPED(CP.CODPED,CP.CODDIV,CP.ANOPED,CP.SEQPED) A37, <span class="hljs-string">'0'</span> A38, CP.CONTACTO A39, 
              DAMELINKWEBTTE(CP.CODPED,CP.CODDIV,CP.ANOPED,CP.SEQPED)  A40, <span class="hljs-string">''</span> A41,
               <span class="hljs-string">''</span> A42, <span class="hljs-string">''</span> A43, <span class="hljs-string">''</span> A44, <span class="hljs-string">'0'</span> A45, <span class="hljs-string">'0'</span> A46, <span class="hljs-string">''</span> A47, <span class="hljs-string">''</span> A48, <span class="hljs-string">'DELIVERED'</span> A49, <span class="hljs-string">''</span> A50, <span class="hljs-string">''</span> A51, <span class="hljs-string">''</span> A52, <span class="hljs-string">''</span> A53, <span class="hljs-string">''</span> A54, <span class="hljs-string">''</span> A55, <span class="hljs-string">''</span> A56, <span class="hljs-string">''</span> A57, <span class="hljs-string">''</span> A58, <span class="hljs-string">''</span> A59, <span class="hljs-string">''</span> A60, <span class="hljs-string">''</span> A61,
                <span class="hljs-string">''</span> A62, <span class="hljs-string">''</span> A63, <span class="hljs-string">''</span> A64, <span class="hljs-string">''</span> A65, <span class="hljs-string">''</span> A66, <span class="hljs-string">''</span> A67, <span class="hljs-string">''</span> A68, <span class="hljs-string">''</span> A69, <span class="hljs-keyword">DECODE</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,CP.CODPED,XCP.SEQDHL) A70, CP.POBLACION A71, AGD.CODCLIAGE A72,
                 <span class="hljs-string">''</span> A73, <span class="hljs-string">''</span> A74, <span class="hljs-string">''</span> A75, <span class="hljs-keyword">CEIL</span>(CP.PESOPEDIDO/<span class="hljs-number">1000</span>) A76, SEQLINEA A77, SEQLINORIG A78, CODARTDIV A79, ART.CODART A80, DESART A81, LP.CANTSERVIDA A82, LP.CANTPEDIDA A83, <span class="hljs-string">''</span> A84, <span class="hljs-string">''</span> A85, <span class="hljs-string">''</span> A86, <span class="hljs-string">''</span> A87, <span class="hljs-string">''</span> A88,
                  <span class="hljs-string">''</span> A89, <span class="hljs-string">''</span> A90, <span class="hljs-string">''</span> A91, <span class="hljs-string">''</span> A92, <span class="hljs-string">''</span> A93, <span class="hljs-string">''</span> A94, <span class="hljs-string">''</span> A95, <span class="hljs-string">''</span> A96, <span class="hljs-string">''</span> A97, <span class="hljs-string">''</span> A98, <span class="hljs-string">''</span> A99, <span class="hljs-string">''</span> A100, <span class="hljs-string">''</span> A101, <span class="hljs-string">''</span> A102, <span class="hljs-string">''</span> A103, <span class="hljs-string">''</span> A104, <span class="hljs-string">''</span> A105, <span class="hljs-string">''</span> A106,
                   <span class="hljs-string">''</span> A107, <span class="hljs-string">''</span> A108, <span class="hljs-string">''</span> A109, <span class="hljs-string">''</span> A110, <span class="hljs-string">''</span> A111, <span class="hljs-string">''</span> A112, <span class="hljs-string">''</span> A113, <span class="hljs-string">''</span> A114, <span class="hljs-string">''</span> A115, <span class="hljs-string">''</span> A116, <span class="hljs-string">''</span> A117, <span class="hljs-string">''</span> A118, <span class="hljs-string">''</span> A119, <span class="hljs-string">''</span> A120, <span class="hljs-string">''</span> A121, <span class="hljs-string">''</span> A122, <span class="hljs-string">''</span> A123, 
                   <span class="hljs-string">''</span> A124, <span class="hljs-string">''</span> A125, <span class="hljs-string">''</span> A126, <span class="hljs-string">''</span> A127, <span class="hljs-string">''</span> A128, <span class="hljs-string">''</span> A129, <span class="hljs-string">''</span> A130, <span class="hljs-string">''</span> A131, <span class="hljs-string">''</span> A132, <span class="hljs-string">''</span> A133, <span class="hljs-string">''</span> A134, <span class="hljs-string">''</span> A135, <span class="hljs-string">''</span> A136, <span class="hljs-string">''</span> A137, <span class="hljs-string">''</span> A138, <span class="hljs-string">''</span> A139, <span class="hljs-string">''</span> A140,
                    <span class="hljs-string">''</span> A141, <span class="hljs-string">''</span> A142, <span class="hljs-string">''</span> A143, <span class="hljs-string">''</span> A144, <span class="hljs-string">''</span> A145, <span class="hljs-string">''</span> A146, <span class="hljs-string">''</span> A147, <span class="hljs-string">''</span> A148, <span class="hljs-string">''</span> A149, <span class="hljs-string">''</span> A150, <span class="hljs-string">''</span> A151, <span class="hljs-string">''</span> A152, <span class="hljs-string">''</span> A153, <span class="hljs-string">''</span> A154, <span class="hljs-string">''</span> A155, <span class="hljs-string">''</span> A156,VALOR
            <span class="hljs-keyword">FROM</span>  IPCABPE CP,IPAGENC AG, IPAGDIV AGD , XIPCABPE XCP,IPPROVI PR,IPDIVIS <span class="hljs-keyword">DIV</span>,IPLINPE LP,IPARTIC ART, (<span class="hljs-keyword">SELECT</span>  VALOR <span class="hljs-keyword">FROM</span> IPLINFMTOINTERFASE 
            <span class="hljs-keyword">WHERE</span> CODTIPOINTERFASE= <span class="hljs-string">'PEDAVIZOR'</span> <span class="hljs-keyword">AND</span> CAMPO=<span class="hljs-string">'A2'</span>) VALOR    
              <span class="hljs-keyword">WHERE</span> CP.CODPROV=PR.CODPROV(+) <span class="hljs-keyword">AND</span> CP.CODPED = LP.CODPED  <span class="hljs-keyword">AND</span> CP.ANOPED = LP.ANOPED 
                <span class="hljs-keyword">AND</span> CP.SEQPED = LP.SEQPED  <span class="hljs-keyword">AND</span> CP.CODDIV = LP.CODDIV <span class="hljs-keyword">AND</span> LP.CODART=ART.CODART 
                <span class="hljs-keyword">AND</span> CP.CODDIV=DIV.CODDIV <span class="hljs-keyword">AND</span> CP.CODPED = XCP.CODPED  <span class="hljs-keyword">AND</span> CP.ANOPED = XCP.ANOPED 
                <span class="hljs-keyword">AND</span> CP.SEQPED = XCP.SEQPED  <span class="hljs-keyword">AND</span> CP.CODDIV = XCP.CODDIV  <span class="hljs-keyword">AND</span> CP.CODAGE = AG.CODAGE 
                <span class="hljs-keyword">AND</span> CP.CODAGE = AGD.CODAGE   <span class="hljs-keyword">AND</span> CP.CODDIV = AGD.CODDIV
                <span class="hljs-keyword">AND</span>  CP.FECRECEP <span class="hljs-keyword">BETWEEN</span> TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(<span class="hljs-string">'20/04/2022'</span>),<span class="hljs-string">'J'</span>) <span class="hljs-keyword">AND</span> FECHASYS <span class="hljs-keyword">AND</span> cp.coddiv=<span class="hljs-string">'471'</span> <span class="hljs-keyword">and</span>
                CP.STATUS <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-number">13000</span>,<span class="hljs-number">13500</span>,<span class="hljs-number">20500</span>) <span class="hljs-keyword">AND</span> CP.STATUS <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">12000</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">29999</span> <span class="hljs-keyword">AND</span> FECENTREGA&gt;=FECHASYS<span class="hljs-number">-1</span> 
           <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> CP.CODPED,CP.SEQPED,CP.ANOPED,CP.CODDIV, <span class="hljs-keyword">decode</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,DAMEPEDIDOI2(CP.CODPED,XCP.SEQDHL),XCP.SEQDHL) ,
                CP.CODCLI,ITEMNAME,DESART,SEQLINEA,SEQLINORIG,LP.CANTPEDIDA,LP.CANTSERVIDA,CODARTDIV,ART.CODART,
                 AG.SERVICIO,PR.DESPROV, <span class="hljs-keyword">DECODE</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,CP.CODPED,XCP.SEQDHL),
                 AGD.CODCLIAGE, CP.CODAGE,CP.CONDENT, CP.FECSERVICIO,
                 CODALB, CONTACTO,DIV.DESDIV, AG.DESAGE ,CP.FECENTREGA,CP.PESOPEDIDO,CP.FECRECEP,CP.FECSALIDA,CP.HORAENTREGA,
                 CODCLI,CP.OBSERV1 , CP.OBSERV2  , CP.OBSERV3 ,CP.CODPROV,
                 DESCLI, CP.DEVALB,  CP.DIRECCION,CP.DIRECCION1,CP.DIRECCION2, <span class="hljs-keyword">SUBSTR</span>(CP.CONTACTO,<span class="hljs-number">1</span>,<span class="hljs-number">40</span>), 
                 CP.POBLACION, CP.PAIS,
                 CP.DP,   CP.TELEFONO,   CP.NIF, PESOPEDIDO,CP.VOLPEDIDO,  <span class="hljs-keyword">SUBSTR</span>(CP.INFOCLIEXTRA,<span class="hljs-number">1</span>,<span class="hljs-number">60</span>), 
                 <span class="hljs-keyword">DECODE</span>(NVL(SWTPORTES,<span class="hljs-string">'S'</span>),<span class="hljs-string">'S'</span>,<span class="hljs-string">'P'</span>,<span class="hljs-string">'N'</span>,<span class="hljs-string">'D'</span>,SWTPORTES),PEDREC,XCP.PALETIZADO,URGENCIA, SWTPORTES,CONDPAGO,VALOR);
 
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP,  ASM2,T2P);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP,  ASM2,T2P);                                               
    EPOSTQUERY 
    BPOSTHIJOS=   
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
BEGINBLOQUE=LEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> <span class="hljs-string">'"'</span>||A1||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A2||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A3||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A4||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A5||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A6||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A7||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A8||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A9||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A10||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A11||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A12||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A13||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A14||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A15||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A16||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A17||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A18||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A19||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A20||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A21||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A22||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A23||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A24||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A25||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A26||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A27||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A28||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A29||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A30||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A31||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A32||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A33||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A34||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A35||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A36||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A37||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A38||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A39||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A40||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A41||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A42||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A43||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A44||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A45||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A46||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A47||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A48||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A49||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A50||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A51||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A52||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A53||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A54||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A55||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A56||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A57||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A58||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A59||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A60||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A61||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A62||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A63||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A64||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A65||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A66||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A67||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A68||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A69||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A70||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A71||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A72||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A73||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A74||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A75||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A76||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A77||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A78||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A79||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A80||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A81||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A82||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A83||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A84||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A85||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A86||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A87||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A88||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A89||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A90||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A91||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A92||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A93||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A94||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A95||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A96||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A97||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A98||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A99||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A100||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A101||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A102||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A103||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A104||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A105||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A106||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A107||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A108||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A109||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A110||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A111||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A112||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A113||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A114||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A115||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A116||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A117||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A118||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A119||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A120||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A121||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A122||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A123||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A124||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A125||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A126||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A127||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A128||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A129||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A130||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A131||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A132||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A133||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>||A134||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A135||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A136||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A137||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A138||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A139||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A140||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A141||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A142||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A143||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A144||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A145||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A146||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A147||<span class="hljs-string">'"'</span>||VALOR
     ||<span class="hljs-string">'"'</span>|| A148||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A149||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A150||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A151||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A152||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A153||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A154||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A155||<span class="hljs-string">'"'</span>||VALOR||<span class="hljs-string">'"'</span>||A156 VALOR <span class="hljs-keyword">FROM</span> ( 
             <span class="hljs-keyword">SELECT</span> <span class="hljs-string">'KAROPHARMA'</span> A1, <span class="hljs-string">'KARES'</span> A2, <span class="hljs-string">'ES'</span> A3, CP.CODPED A4, CP.CODALB A5, <span class="hljs-string">''</span> A6, <span class="hljs-keyword">DECODE</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,CP.CODPED,XCP.SEQDHL) A7, AG.DESAGE A8, <span class="hljs-string">'ES'</span> A9, AGD.CODCLIAGE A10, CP.CODCLI A11, CP.DESCLI A12,
             CP.DIRECCION A13, CP.DIRECCION1 A14, CP.DIRECCION2 A15, CP.PAIS A16, CP.CODPROV A17, CP.TELEFONO A18, <span class="hljs-string">''</span> A19, <span class="hljs-string">'1900'</span> A20, 
             <span class="hljs-keyword">decode</span>(cp.fecservicio,<span class="hljs-number">0</span>,TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECRECEP+<span class="hljs-number">2</span>,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>),TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECSERVICIO,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>)) A21, 
             TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECENTREGA,<span class="hljs-string">'J'</span>),<span class="hljs-string">'RRRRMMDD'</span>) A22, <span class="hljs-keyword">SUBSTR</span>(<span class="hljs-keyword">REPLACE</span>(CP.HORAENTREGA,<span class="hljs-string">':'</span>,<span class="hljs-string">''</span>),<span class="hljs-number">1</span>,<span class="hljs-number">4</span>) A23,  <span class="hljs-keyword">SUBSTR</span>(<span class="hljs-keyword">REPLACE</span>(CP.HORAENTREGA,<span class="hljs-string">':'</span>,<span class="hljs-string">''</span>),<span class="hljs-number">1</span>,<span class="hljs-number">4</span>) A24, <span class="hljs-string">'NYYYYYN'</span> A25, <span class="hljs-string">'1000'</span> A26, <span class="hljs-string">'2000'</span> A27, <span class="hljs-string">'ACTIVE'</span> A28, <span class="hljs-keyword">CEIL</span>(CP.PESOPEDIDO/<span class="hljs-number">1000</span>) A29,
              <span class="hljs-string">'0'</span> A30, <span class="hljs-string">'0'</span> A31, <span class="hljs-string">''</span> A32, <span class="hljs-string">'N'</span> A33, <span class="hljs-string">'N'</span> A34, <span class="hljs-string">'N'</span> A35, <span class="hljs-string">''</span> A36, DAMEBULTOSPED(CP.CODPED,CP.CODDIV,CP.ANOPED,CP.SEQPED) A37, <span class="hljs-string">'0'</span> A38, CP.CONTACTO A39, 
              DAMELINKWEBTTE(CP.CODPED,CP.CODDIV,CP.ANOPED,CP.SEQPED)  A40, <span class="hljs-string">''</span> A41,
               <span class="hljs-string">''</span> A42, <span class="hljs-string">''</span> A43, <span class="hljs-string">''</span> A44, <span class="hljs-string">'0'</span> A45, <span class="hljs-string">'0'</span> A46, <span class="hljs-string">''</span> A47, <span class="hljs-string">''</span> A48, <span class="hljs-string">'DELIVERED'</span> A49, <span class="hljs-string">''</span> A50, <span class="hljs-string">''</span> A51, <span class="hljs-string">''</span> A52, <span class="hljs-string">''</span> A53, <span class="hljs-string">''</span> A54, <span class="hljs-string">''</span> A55, <span class="hljs-string">''</span> A56, <span class="hljs-string">''</span> A57, <span class="hljs-string">''</span> A58, <span class="hljs-string">''</span> A59, <span class="hljs-string">''</span> A60, <span class="hljs-string">''</span> A61,
                <span class="hljs-string">''</span> A62, <span class="hljs-string">''</span> A63, <span class="hljs-string">''</span> A64, <span class="hljs-string">''</span> A65, <span class="hljs-string">''</span> A66, <span class="hljs-string">''</span> A67, <span class="hljs-string">''</span> A68, <span class="hljs-string">''</span> A69, <span class="hljs-keyword">DECODE</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,CP.CODPED,XCP.SEQDHL) A70, CP.POBLACION A71, AGD.CODCLIAGE A72,
                 <span class="hljs-string">''</span> A73, <span class="hljs-string">''</span> A74, <span class="hljs-string">''</span> A75, <span class="hljs-keyword">CEIL</span>(CP.PESOPEDIDO/<span class="hljs-number">1000</span>) A76, SEQLINEA A77, SEQLINORIG A78, CODARTDIV A79, ART.CODART A80, DESART A81, LP.CANTSERVIDA A82, LP.CANTPEDIDA A83, <span class="hljs-string">''</span> A84, <span class="hljs-string">''</span> A85, <span class="hljs-string">''</span> A86, <span class="hljs-string">''</span> A87, <span class="hljs-string">''</span> A88,
                  <span class="hljs-string">''</span> A89, <span class="hljs-string">''</span> A90, <span class="hljs-string">''</span> A91, <span class="hljs-string">''</span> A92, <span class="hljs-string">''</span> A93, <span class="hljs-string">''</span> A94, <span class="hljs-string">''</span> A95, <span class="hljs-string">''</span> A96, <span class="hljs-string">''</span> A97, <span class="hljs-string">''</span> A98, <span class="hljs-string">''</span> A99, <span class="hljs-string">''</span> A100, <span class="hljs-string">''</span> A101, <span class="hljs-string">''</span> A102, <span class="hljs-string">''</span> A103, <span class="hljs-string">''</span> A104, <span class="hljs-string">''</span> A105, <span class="hljs-string">''</span> A106,
                   <span class="hljs-string">''</span> A107, <span class="hljs-string">''</span> A108, <span class="hljs-string">''</span> A109, <span class="hljs-string">''</span> A110, <span class="hljs-string">''</span> A111, <span class="hljs-string">''</span> A112, <span class="hljs-string">''</span> A113, <span class="hljs-string">''</span> A114, <span class="hljs-string">''</span> A115, <span class="hljs-string">''</span> A116, <span class="hljs-string">''</span> A117, <span class="hljs-string">''</span> A118, <span class="hljs-string">''</span> A119, <span class="hljs-string">''</span> A120, <span class="hljs-string">''</span> A121, <span class="hljs-string">''</span> A122, <span class="hljs-string">''</span> A123, 
                   <span class="hljs-string">''</span> A124, <span class="hljs-string">''</span> A125, <span class="hljs-string">''</span> A126, <span class="hljs-string">''</span> A127, <span class="hljs-string">''</span> A128, <span class="hljs-string">''</span> A129, <span class="hljs-string">''</span> A130, <span class="hljs-string">''</span> A131, <span class="hljs-string">''</span> A132, <span class="hljs-string">''</span> A133, <span class="hljs-string">''</span> A134, <span class="hljs-string">''</span> A135, <span class="hljs-string">''</span> A136, <span class="hljs-string">''</span> A137, <span class="hljs-string">''</span> A138, <span class="hljs-string">''</span> A139, <span class="hljs-string">''</span> A140,
                    <span class="hljs-string">''</span> A141, <span class="hljs-string">''</span> A142, <span class="hljs-string">''</span> A143, <span class="hljs-string">''</span> A144, <span class="hljs-string">''</span> A145, <span class="hljs-string">''</span> A146, <span class="hljs-string">''</span> A147, <span class="hljs-string">''</span> A148, <span class="hljs-string">''</span> A149, <span class="hljs-string">''</span> A150, <span class="hljs-string">''</span> A151, <span class="hljs-string">''</span> A152, <span class="hljs-string">''</span> A153, <span class="hljs-string">''</span> A154, <span class="hljs-string">''</span> A155, <span class="hljs-string">''</span> A156,VALOR
            <span class="hljs-keyword">FROM</span>  IPCABPE CP,IPAGENC AG, IPAGDIV AGD , XIPCABPE XCP,IPPROVI PR,IPDIVIS <span class="hljs-keyword">DIV</span>,IPLINPE LP,IPARTIC ART, (<span class="hljs-keyword">SELECT</span>  VALOR <span class="hljs-keyword">FROM</span> IPLINFMTOINTERFASE 
            <span class="hljs-keyword">WHERE</span> CODTIPOINTERFASE= <span class="hljs-string">'PEDAVIZOR'</span> <span class="hljs-keyword">AND</span> CAMPO=<span class="hljs-string">'A2'</span>) VALOR    
              <span class="hljs-keyword">WHERE</span> CP.CODPROV=PR.CODPROV(+) <span class="hljs-keyword">AND</span> CP.CODPED = LP.CODPED  <span class="hljs-keyword">AND</span> CP.ANOPED = LP.ANOPED 
                <span class="hljs-keyword">AND</span> CP.SEQPED = LP.SEQPED  <span class="hljs-keyword">AND</span> CP.CODDIV = LP.CODDIV <span class="hljs-keyword">AND</span> LP.CODART=ART.CODART 
                <span class="hljs-keyword">AND</span> CP.CODDIV=DIV.CODDIV <span class="hljs-keyword">AND</span> CP.CODPED = XCP.CODPED  <span class="hljs-keyword">AND</span> CP.ANOPED = XCP.ANOPED 
                <span class="hljs-keyword">AND</span> CP.SEQPED = XCP.SEQPED  <span class="hljs-keyword">AND</span> CP.CODDIV = XCP.CODDIV  <span class="hljs-keyword">AND</span> CP.CODAGE = AG.CODAGE 
                <span class="hljs-keyword">AND</span> CP.CODAGE = AGD.CODAGE   <span class="hljs-keyword">AND</span> CP.CODDIV = AGD.CODDIV
                <span class="hljs-keyword">AND</span>  CP.FECRECEP <span class="hljs-keyword">BETWEEN</span> TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(<span class="hljs-string">'20/04/2022'</span>),<span class="hljs-string">'J'</span>) <span class="hljs-keyword">AND</span> FECHASYS <span class="hljs-keyword">AND</span> cp.coddiv=<span class="hljs-string">'471'</span> <span class="hljs-keyword">and</span>
                CP.STATUS <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-number">13000</span>,<span class="hljs-number">13500</span>,<span class="hljs-number">20500</span>) <span class="hljs-keyword">AND</span> CP.STATUS <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">12000</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">29999</span> <span class="hljs-keyword">AND</span> FECENTREGA&gt;=FECHASYS<span class="hljs-number">-6</span> 
           <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> CP.CODPED,CP.SEQPED,CP.ANOPED,CP.CODDIV, <span class="hljs-keyword">decode</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,DAMEPEDIDOI2(CP.CODPED,XCP.SEQDHL),XCP.SEQDHL) ,
                CP.CODCLI,ITEMNAME,DESART,SEQLINEA,SEQLINORIG,LP.CANTPEDIDA,LP.CANTSERVIDA,CODARTDIV,ART.CODART,
                 AG.SERVICIO,PR.DESPROV, <span class="hljs-keyword">DECODE</span>(XCP.SEQDHL,<span class="hljs-number">0</span>,CP.CODPED,XCP.SEQDHL),
                 AGD.CODCLIAGE, CP.CODAGE,CP.CONDENT, CP.FECSERVICIO,
                 CODALB, CONTACTO,DIV.DESDIV, AG.DESAGE ,CP.FECENTREGA,CP.PESOPEDIDO,CP.FECRECEP,CP.FECSALIDA,CP.HORAENTREGA,
                 CODCLI,CP.OBSERV1 , CP.OBSERV2  , CP.OBSERV3 ,CP.CODPROV,
                 DESCLI, CP.DEVALB,  CP.DIRECCION,CP.DIRECCION1,CP.DIRECCION2, <span class="hljs-keyword">SUBSTR</span>(CP.CONTACTO,<span class="hljs-number">1</span>,<span class="hljs-number">40</span>), 
                 CP.POBLACION, CP.PAIS,
                 CP.DP,   CP.TELEFONO,   CP.NIF, PESOPEDIDO,CP.VOLPEDIDO,  <span class="hljs-keyword">SUBSTR</span>(CP.INFOCLIEXTRA,<span class="hljs-number">1</span>,<span class="hljs-number">60</span>), 
                 <span class="hljs-keyword">DECODE</span>(NVL(SWTPORTES,<span class="hljs-string">'S'</span>),<span class="hljs-string">'S'</span>,<span class="hljs-string">'P'</span>,<span class="hljs-string">'N'</span>,<span class="hljs-string">'D'</span>,SWTPORTES),PEDREC,XCP.PALETIZADO,URGENCIA, SWTPORTES,CONDPAGO,VALOR);
 
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP,  ASM2,T2P);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP,  ASM2,T2P);                                               
    EPOSTQUERY 
    BPOSTHIJOS=   
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
</div></code></pre>
<div id='id_stock_transaction' />
<h4 id="stock-transactions">Stock Transactions</h4>
<p>Se debe configurar el IFL I2H.INBTRANSACMOVEXXX  (siendo xxx la división correspondiente). Los archivos ya existen se deben modificar para la división requerida.</p>
<p>Para KARO tomamos el IFL de la división 198 como base: <strong>I2H.INBTRANSACMOVE198.ifl</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
    BPOSTHIJOS=          
<span class="hljs-comment">#          UPDATE IPSERIEEXP SET status=20000,CODOPEMODIF='CABLINEXP001',HORAMODIF=HORASYS,FECMODIF=FECHASYS  </span>
           <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
 
BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'INBTransaction'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW 
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>   <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'198'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
 
 
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> <span class="hljs-string">'KKINEWCO'</span> A1, <span class="hljs-string">'KKNEES'</span> A2, <span class="hljs-string">'ES'</span> A3,  ITEMNAME A4,  ITEMNAME A5, 
              CMV.CODMOV A6, 
        LMV.CODLOT A7, LOT.CADUCI A8, <span class="hljs-keyword">LPAD</span>(<span class="hljs-keyword">sum</span>(CANTIDAD),<span class="hljs-number">8</span>,<span class="hljs-number">0</span>)||<span class="hljs-string">'.0000'</span> A9,<span class="hljs-string">'EACH'</span> A10,<span class="hljs-keyword">DECODE</span>(coc.CODCONCE,<span class="hljs-string">'IPENTSTD'</span>,<span class="hljs-string">'RECSUP'</span>, <span class="hljs-string">'IPCAMCAL-'</span>,<span class="hljs-string">'Move'</span>,<span class="hljs-string">'Adjustment'</span>) A11, XES.definition A12, 
        (<span class="hljs-keyword">SELECT</span> XES2.definition <span class="hljs-keyword">FROM</span> IPCABMV CMV2, IPLINMV LMV2, XIPESTADOS XES2 <span class="hljs-keyword">WHERE</span> CMV2.CODMOVREG=CMV.CODMOV <span class="hljs-keyword">AND</span> LMV2.CODMOV=CMV2.CODMOV 
        <span class="hljs-keyword">AND</span> XES2.ESTADO(+)=LMV2.BLOQUEOS  <span class="hljs-keyword">and</span> <span class="hljs-keyword">rownum</span>=<span class="hljs-number">1</span>) A13,<span class="hljs-string">''</span> A14,
        <span class="hljs-keyword">DECODE</span>(COC.TIPOCONCE,<span class="hljs-string">'E'</span>,<span class="hljs-string">'+'</span>,<span class="hljs-string">'-'</span>)  A15, DESCONCE A16, 
           CMV.CODMOV A17, <span class="hljs-string">''</span>  A18, <span class="hljs-keyword">DECODE</span>(coc.CODCONCE,<span class="hljs-string">'IPENTSTD'</span>,(<span class="hljs-keyword">SELECT</span> CODORDREC <span class="hljs-keyword">FROM</span> IPCABREC CRE <span class="hljs-keyword">WHERE</span> CRE.CODRECEP=LMV.CODRECEP), CMV.CODMOV)  A19, <span class="hljs-string">''</span> A20, TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYYYMMDD'</span>) A21, CMV.CODMOV
             <span class="hljs-keyword">FROM</span> IPCONCEPTO COC, IPCONCEPTODIV CDI, IPLINMV LMV, IPCABMV CMV, IPARTIC ART,IPLOTES LOT, XIPESTADOS XES 
            <span class="hljs-keyword">WHERE</span> CMV.STATUS+<span class="hljs-number">0</span> <span class="hljs-keyword">in</span> (<span class="hljs-number">12000</span>,<span class="hljs-number">15000</span>)
                  <span class="hljs-keyword">AND</span> LMV.CODMOV=CMV.CODMOV
                  <span class="hljs-keyword">AND</span> CMV.CODCONCE=COC.CODCONCE
                  <span class="hljs-keyword">AND</span> COC.TIPOCONCE <span class="hljs-keyword">IN</span> (<span class="hljs-string">'E'</span>,<span class="hljs-string">'S'</span>)
                  <span class="hljs-keyword">AND</span> CDI.CODCONCE=COC.CODCONCE
                  <span class="hljs-keyword">AND</span> CDI.TRANSMITIR||<span class="hljs-string">''</span>=<span class="hljs-string">'S'</span>
                  <span class="hljs-keyword">AND</span> CDI.CODDIV||<span class="hljs-string">''</span>=:CODDIV
                  <span class="hljs-keyword">AND</span> ART.CODART=LMV.CODART 
                  <span class="hljs-keyword">AND</span> ART.CODDIV=CDI.CODDIV
                  <span class="hljs-keyword">AND</span> LMV.CODART=LOT.CODART
                  <span class="hljs-keyword">AND</span> LMV.CODLOT=LOT.CODLOT <span class="hljs-keyword">AND</span> <span class="hljs-keyword">SUBSTR</span>(LMV.BLOQUEOS,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>)||<span class="hljs-string">''</span>&lt;&gt;<span class="hljs-string">'1'</span>
                  <span class="hljs-keyword">AND</span> ART.CODDIV||<span class="hljs-string">''</span>=:CODDIV <span class="hljs-keyword">AND</span> XES.ESTADO(+)=LMV.BLOQUEOS  <span class="hljs-keyword">AND</span> CMV.FECFINMOV&gt;=FECHASYS<span class="hljs-number">-20</span> <span class="hljs-keyword">AND</span> CMV.CODCONCE <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-string">'IPENTSTD'</span>,<span class="hljs-string">'IPCAMCAL+'</span>)
         <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>  ART.CODDIV, CODARTDIV , CMV.CODMOV ,LMV.CODLOT , LOT.CADUCI , DESCONCE ,coc.CODCONCE,XES.definition ,CMV.CODMOVREG,ITEMNAME ,LMV.CODRECEP,COC.TIPOCONCE
         <span class="hljs-keyword">UNION</span>
         <span class="hljs-keyword">SELECT</span> <span class="hljs-string">'KKINEWCO'</span> A1, <span class="hljs-string">'KKNEES'</span> A2, <span class="hljs-string">'ES'</span> A3,  ITEMNAME A4,  ITEMNAME A5, 
              CMV.CODMOV A6, 
        LMV.CODLOT A7, LOT.CADUCI A8, <span class="hljs-keyword">LPAD</span>(<span class="hljs-keyword">sum</span>(LMV.CANTIDAD),<span class="hljs-number">8</span>,<span class="hljs-number">0</span>)||<span class="hljs-string">'.0000'</span> A9,<span class="hljs-string">'EACH'</span> A10,<span class="hljs-keyword">DECODE</span>(coc.CODCONCE,<span class="hljs-string">'IPENTSTD'</span>,<span class="hljs-string">'RECSUP'</span>, <span class="hljs-string">'Adjustment'</span>) A11, XES.definition A12, 
        (<span class="hljs-keyword">SELECT</span> XES2.definition <span class="hljs-keyword">FROM</span> IPCABMV CMV2, IPLINMV LMV2, XIPESTADOS XES2 <span class="hljs-keyword">WHERE</span> CMV2.CODMOVREG=CMV.CODMOV <span class="hljs-keyword">AND</span> LMV2.CODMOV=CMV2.CODMOV 
        <span class="hljs-keyword">AND</span> XES2.ESTADO(+)=LMV2.BLOQUEOS  <span class="hljs-keyword">and</span> <span class="hljs-keyword">rownum</span>=<span class="hljs-number">1</span>) A13,<span class="hljs-string">''</span> A14,
        <span class="hljs-keyword">DECODE</span>(COC.TIPOCONCE,<span class="hljs-string">'E'</span>,<span class="hljs-string">'+'</span>,<span class="hljs-string">'-'</span>)  A15, DESCONCE A16, 
           CMV.CODMOV A17, <span class="hljs-string">''</span>  A18, <span class="hljs-keyword">DECODE</span>(coc.CODCONCE,<span class="hljs-string">'IPENTSTD'</span>,(<span class="hljs-keyword">SELECT</span> CODORDREC <span class="hljs-keyword">FROM</span> IPCABREC CRE <span class="hljs-keyword">WHERE</span> CRE.CODRECEP=LMV.CODRECEP), CMV.CODMOV)  A19,PIECE(LRO.CLAVEEXT,<span class="hljs-string">'@'</span>,<span class="hljs-number">1</span>)  A20, TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYYYMMDD'</span>) A21, 
           CMV.CODMOV
             <span class="hljs-keyword">FROM</span> IPCONCEPTO COC, IPCONCEPTODIV CDI, IPLINMV LMV, IPCABMV CMV, IPARTIC ART,IPLOTES LOT, XIPESTADOS XES,IPLINREC LRC,IPLINORDREC LRO  
            <span class="hljs-keyword">WHERE</span> CMV.STATUS+<span class="hljs-number">0</span> <span class="hljs-keyword">in</span> (<span class="hljs-number">12000</span>,<span class="hljs-number">15000</span>) <span class="hljs-keyword">AND</span> LRO.SECLINORD=LRC.SECLINORD <span class="hljs-keyword">AND</span> LRO.CODART=LRC.CODART <span class="hljs-keyword">AND</span> LRO.CODORDREC=LRC.CODORDREC <span class="hljs-keyword">AND</span> LRC.CODDIV=LRO.CODDIV 
                  <span class="hljs-keyword">AND</span> LMV.CODMOV=CMV.CODMOV <span class="hljs-keyword">AND</span> CMV.CODCONCE=<span class="hljs-string">'IPENTSTD'</span> <span class="hljs-keyword">AND</span> CMV.CODUBIORI||<span class="hljs-string">''</span>=<span class="hljs-string">'FPULMON'</span> 
                  <span class="hljs-keyword">AND</span> CMV.CODCONCE=COC.CODCONCE
                  <span class="hljs-keyword">AND</span> COC.TIPOCONCE <span class="hljs-keyword">IN</span> (<span class="hljs-string">'E'</span>,<span class="hljs-string">'S'</span>)
                  <span class="hljs-keyword">AND</span> CDI.CODCONCE=COC.CODCONCE
                  <span class="hljs-keyword">AND</span> CDI.TRANSMITIR||<span class="hljs-string">''</span>=<span class="hljs-string">'S'</span>
                  <span class="hljs-keyword">AND</span> CDI.CODDIV||<span class="hljs-string">''</span>=:CODDIV
                  <span class="hljs-keyword">AND</span> ART.CODART=LMV.CODART 
                  <span class="hljs-keyword">AND</span> ART.CODDIV=CDI.CODDIV
                  <span class="hljs-keyword">AND</span> LMV.CODRECEP=LRC.CODRECEP(+)  
                  <span class="hljs-keyword">AND</span> LMV.CODART=LRC.CODART(+) 
                  <span class="hljs-keyword">AND</span> LMV.CODLOT=LRC.CODLOT(+)
                  <span class="hljs-keyword">AND</span> LMV.CODART=LOT.CODART
                  <span class="hljs-keyword">AND</span> LMV.CODLOT=LOT.CODLOT <span class="hljs-keyword">AND</span> <span class="hljs-keyword">SUBSTR</span>(LMV.BLOQUEOS,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>)||<span class="hljs-string">''</span>&lt;&gt;<span class="hljs-string">'1'</span>
                  <span class="hljs-keyword">AND</span> ART.CODDIV||<span class="hljs-string">''</span>=:CODDIV <span class="hljs-keyword">AND</span> XES.ESTADO(+)=LMV.BLOQUEOS  <span class="hljs-keyword">AND</span> CMV.FECFINMOV&gt;=FECHASYS<span class="hljs-number">-10</span> 
         <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>  ART.CODDIV, CODARTDIV , CMV.CODMOV ,LMV.CODLOT , LOT.CADUCI , DESCONCE ,coc.CODCONCE,XES.definition ,CMV.CODMOVREG,ITEMNAME ,LMV.CODRECEP,PIECE(LRO.CLAVEEXT,<span class="hljs-string">'@'</span>,<span class="hljs-number">1</span>),COC.TIPOCONCE ;
 
<span class="hljs-comment">#AND FECDEVUELTO=0 </span>
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP, GWTRANSC,GWTRANSC);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP, GWTRANSC,GWTRANSC);                                               
    EPOSTQUERY 
    BPOSTHIJOS=
           <span class="hljs-keyword">UPDATE</span> IPCABMV <span class="hljs-keyword">SET</span> <span class="hljs-keyword">STATUS</span>=<span class="hljs-number">20000</span> <span class="hljs-keyword">WHERE</span> CODMOV=:CODMOV;     
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
</div></code></pre>
<p>En primer lugar, modificamos CODDIV (471 para KARO)</p>
<pre class="hljs"><code><div>BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'INBTransaction'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW 
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>   <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'471'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
</div></code></pre>
<p>A continuación modificamos el campo A1 que corresponde al CLIENT_ID. En nuestro caso ‘KAROPHARMA’ Para KARO.
Y modificamos el campo A2 que corresponde al VENDOR_ID. En nuestro caso es ‘KARES’ Para KARO.</p>
<pre class="hljs"><code><div>BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> <span class="hljs-string">'KAROPHARMA'</span> A1, <span class="hljs-string">'KARES'</span> A2...
         <span class="hljs-keyword">UNION</span>
         <span class="hljs-keyword">SELECT</span> <span class="hljs-string">'KAROPHARMA'</span> A1, <span class="hljs-string">'KARES'</span> A2...
</div></code></pre>
<p>El archivo final sería  <strong>I2H.INBTRANSACMOVE471.ifl</strong> y queda como se muestra a continuación:</p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
    BPOSTHIJOS=          
<span class="hljs-comment">#          UPDATE IPSERIEEXP SET status=20000,CODOPEMODIF='CABLINEXP001',HORAMODIF=HORASYS,FECMODIF=FECHASYS  </span>
           <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
 
BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'UAT_INB_ES_Transaction'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW 
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>   <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'471'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
 
 
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> <span class="hljs-string">'KAROPHARMA'</span> A1, <span class="hljs-string">'KARES'</span> A2, <span class="hljs-string">'ES'</span> A3,  ART.CODART A4,  NVL(ART.CODARTDIV,ART.CODART) A5, 
              CMV.CODMOV A6, 
        LMV.CODLOT A7, LOT.CADUCI A8, <span class="hljs-keyword">LPAD</span>(<span class="hljs-keyword">sum</span>(CANTIDAD),<span class="hljs-number">8</span>,<span class="hljs-number">0</span>)||<span class="hljs-string">'.0000'</span> A9,<span class="hljs-string">'EACH'</span> A10,<span class="hljs-keyword">DECODE</span>(coc.CODCONCE,<span class="hljs-string">'IPENTSTD'</span>,<span class="hljs-string">'RECSUP'</span>, <span class="hljs-string">'IPCAMCAL-'</span>,<span class="hljs-string">'Move'</span>,<span class="hljs-string">'Adjustment'</span>) A11, XES.definition A12, 
        (<span class="hljs-keyword">SELECT</span> XES2.definition <span class="hljs-keyword">FROM</span> IPCABMV CMV2, IPLINMV LMV2, XIPESTADOS XES2 <span class="hljs-keyword">WHERE</span> CMV2.CODMOVREG=CMV.CODMOV <span class="hljs-keyword">AND</span> LMV2.CODMOV=CMV2.CODMOV 
        <span class="hljs-keyword">AND</span> XES2.ESTADO(+)=LMV2.BLOQUEOS  <span class="hljs-keyword">and</span> <span class="hljs-keyword">rownum</span>=<span class="hljs-number">1</span>) A13,<span class="hljs-string">''</span> A14,
        <span class="hljs-keyword">DECODE</span>(COC.TIPOCONCE,<span class="hljs-string">'E'</span>,<span class="hljs-string">'+'</span>,<span class="hljs-string">'-'</span>)  A15, DESCONCE A16, 
           CMV.CODMOV A17, <span class="hljs-string">''</span>  A18, <span class="hljs-keyword">DECODE</span>(coc.CODCONCE,<span class="hljs-string">'IPENTSTD'</span>,(<span class="hljs-keyword">SELECT</span> CODORDREC <span class="hljs-keyword">FROM</span> IPCABREC CRE <span class="hljs-keyword">WHERE</span> CRE.CODRECEP=LMV.CODRECEP), CMV.CODMOV)  A19, <span class="hljs-string">''</span> A20, TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYYYMMDD'</span>) A21, CMV.CODMOV
             <span class="hljs-keyword">FROM</span> IPCONCEPTO COC, IPCONCEPTODIV CDI, IPLINMV LMV, IPCABMV CMV, IPARTIC ART,IPLOTES LOT, XIPESTADOS XES 
            <span class="hljs-keyword">WHERE</span> CMV.STATUS+<span class="hljs-number">0</span> <span class="hljs-keyword">in</span> (<span class="hljs-number">12000</span>,<span class="hljs-number">15000</span>)
                  <span class="hljs-keyword">AND</span> LMV.CODMOV=CMV.CODMOV
                  <span class="hljs-keyword">AND</span> CMV.CODCONCE=COC.CODCONCE
                  <span class="hljs-keyword">AND</span> COC.TIPOCONCE <span class="hljs-keyword">IN</span> (<span class="hljs-string">'E'</span>,<span class="hljs-string">'S'</span>)
                  <span class="hljs-keyword">AND</span> CDI.CODCONCE=COC.CODCONCE
                  <span class="hljs-keyword">AND</span> CDI.TRANSMITIR||<span class="hljs-string">''</span>=<span class="hljs-string">'S'</span>
                  <span class="hljs-keyword">AND</span> CDI.CODDIV||<span class="hljs-string">''</span>=:CODDIV
                  <span class="hljs-keyword">AND</span> ART.CODART=LMV.CODART 
                  <span class="hljs-keyword">AND</span> ART.CODDIV=CDI.CODDIV
                  <span class="hljs-keyword">AND</span> LMV.CODART=LOT.CODART
                  <span class="hljs-keyword">AND</span> LMV.CODLOT=LOT.CODLOT <span class="hljs-keyword">AND</span> <span class="hljs-keyword">SUBSTR</span>(LMV.BLOQUEOS,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>)||<span class="hljs-string">''</span>&lt;&gt;<span class="hljs-string">'1'</span>
                  <span class="hljs-keyword">AND</span> ART.CODDIV||<span class="hljs-string">''</span>=:CODDIV <span class="hljs-keyword">AND</span> XES.ESTADO(+)=LMV.BLOQUEOS  <span class="hljs-keyword">AND</span> CMV.FECFINMOV&gt;=FECHASYS<span class="hljs-number">-20</span> <span class="hljs-keyword">AND</span> CMV.CODCONCE <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-string">'IPENTSTD'</span>,<span class="hljs-string">'IPCAMCAL+'</span>)
         <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>  ART.CODDIV, CODARTDIV , CMV.CODMOV ,LMV.CODLOT , LOT.CADUCI , DESCONCE ,coc.CODCONCE,XES.definition ,CMV.CODMOVREG,ART.CODART ,LMV.CODRECEP,COC.TIPOCONCE
         <span class="hljs-keyword">UNION</span>
         <span class="hljs-keyword">SELECT</span> <span class="hljs-string">'KAROPHARMA'</span> A1, <span class="hljs-string">'KARES'</span> A2, <span class="hljs-string">'ES'</span> A3,  ART.CODART A4,  NVL(ART.CODARTDIV,ART.CODART) A5, 
              CMV.CODMOV A6, 
        LMV.CODLOT A7, LOT.CADUCI A8, <span class="hljs-keyword">LPAD</span>(<span class="hljs-keyword">sum</span>(LMV.CANTIDAD),<span class="hljs-number">8</span>,<span class="hljs-number">0</span>)||<span class="hljs-string">'.0000'</span> A9,<span class="hljs-string">'EACH'</span> A10,<span class="hljs-keyword">DECODE</span>(coc.CODCONCE,<span class="hljs-string">'IPENTSTD'</span>,<span class="hljs-string">'RECSUP'</span>, <span class="hljs-string">'Adjustment'</span>) A11, XES.definition A12, 
        (<span class="hljs-keyword">SELECT</span> XES2.definition <span class="hljs-keyword">FROM</span> IPCABMV CMV2, IPLINMV LMV2, XIPESTADOS XES2 <span class="hljs-keyword">WHERE</span> CMV2.CODMOVREG=CMV.CODMOV <span class="hljs-keyword">AND</span> LMV2.CODMOV=CMV2.CODMOV 
        <span class="hljs-keyword">AND</span> XES2.ESTADO(+)=LMV2.BLOQUEOS  <span class="hljs-keyword">and</span> <span class="hljs-keyword">rownum</span>=<span class="hljs-number">1</span>) A13,<span class="hljs-string">''</span> A14,
        <span class="hljs-keyword">DECODE</span>(COC.TIPOCONCE,<span class="hljs-string">'E'</span>,<span class="hljs-string">'+'</span>,<span class="hljs-string">'-'</span>)  A15, DESCONCE A16, 
           CMV.CODMOV A17, <span class="hljs-string">''</span>  A18, <span class="hljs-keyword">DECODE</span>(coc.CODCONCE,<span class="hljs-string">'IPENTSTD'</span>,(<span class="hljs-keyword">SELECT</span> CODORDREC <span class="hljs-keyword">FROM</span> IPCABREC CRE <span class="hljs-keyword">WHERE</span> CRE.CODRECEP=LMV.CODRECEP), CMV.CODMOV)  A19,PIECE(LRO.CLAVEEXT,<span class="hljs-string">'@'</span>,<span class="hljs-number">1</span>)  A20, TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYYYMMDD'</span>) A21, 
           CMV.CODMOV
             <span class="hljs-keyword">FROM</span> IPCONCEPTO COC, IPCONCEPTODIV CDI, IPLINMV LMV, IPCABMV CMV, IPARTIC ART,IPLOTES LOT, XIPESTADOS XES,IPLINREC LRC,IPLINORDREC LRO  
            <span class="hljs-keyword">WHERE</span> CMV.STATUS+<span class="hljs-number">0</span> <span class="hljs-keyword">in</span> (<span class="hljs-number">12000</span>,<span class="hljs-number">15000</span>) <span class="hljs-keyword">AND</span> LRO.SECLINORD=LRC.SECLINORD <span class="hljs-keyword">AND</span> LRO.CODART=LRC.CODART <span class="hljs-keyword">AND</span> LRO.CODORDREC=LRC.CODORDREC <span class="hljs-keyword">AND</span> LRC.CODDIV=LRO.CODDIV 
                  <span class="hljs-keyword">AND</span> LMV.CODMOV=CMV.CODMOV <span class="hljs-keyword">AND</span> CMV.CODCONCE=<span class="hljs-string">'IPENTSTD'</span> <span class="hljs-keyword">AND</span> CMV.CODUBIORI||<span class="hljs-string">''</span>=<span class="hljs-string">'FPULMON'</span> 
                  <span class="hljs-keyword">AND</span> CMV.CODCONCE=COC.CODCONCE
                  <span class="hljs-keyword">AND</span> COC.TIPOCONCE <span class="hljs-keyword">IN</span> (<span class="hljs-string">'E'</span>,<span class="hljs-string">'S'</span>)
                  <span class="hljs-keyword">AND</span> CDI.CODCONCE=COC.CODCONCE
                  <span class="hljs-keyword">AND</span> CDI.TRANSMITIR||<span class="hljs-string">''</span>=<span class="hljs-string">'S'</span>
                  <span class="hljs-keyword">AND</span> CDI.CODDIV||<span class="hljs-string">''</span>=:CODDIV
                  <span class="hljs-keyword">AND</span> ART.CODART=LMV.CODART 
                  <span class="hljs-keyword">AND</span> ART.CODDIV=CDI.CODDIV
                  <span class="hljs-keyword">AND</span> LMV.CODRECEP=LRC.CODRECEP(+)  
                  <span class="hljs-keyword">AND</span> LMV.CODART=LRC.CODART(+) 
                  <span class="hljs-keyword">AND</span> LMV.CODLOT=LRC.CODLOT(+)
                  <span class="hljs-keyword">AND</span> LMV.CODART=LOT.CODART
                  <span class="hljs-keyword">AND</span> LMV.CODLOT=LOT.CODLOT <span class="hljs-keyword">AND</span> <span class="hljs-keyword">SUBSTR</span>(LMV.BLOQUEOS,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>)||<span class="hljs-string">''</span>&lt;&gt;<span class="hljs-string">'1'</span>
                  <span class="hljs-keyword">AND</span> ART.CODDIV||<span class="hljs-string">''</span>=:CODDIV <span class="hljs-keyword">AND</span> XES.ESTADO(+)=LMV.BLOQUEOS  <span class="hljs-keyword">AND</span> CMV.FECFINMOV&gt;=FECHASYS<span class="hljs-number">-10</span> 
         <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>  ART.CODDIV, CODARTDIV , CMV.CODMOV ,LMV.CODLOT , LOT.CADUCI , DESCONCE ,coc.CODCONCE,XES.definition ,CMV.CODMOVREG,ART.CODART ,LMV.CODRECEP,PIECE(LRO.CLAVEEXT,<span class="hljs-string">'@'</span>,<span class="hljs-number">1</span>),COC.TIPOCONCE ;
 
<span class="hljs-comment">#AND FECDEVUELTO=0 </span>
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP, GWTRANSC,GWTRANSC);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP, GWTRANSC,GWTRANSC);                                               
    EPOSTQUERY 
    BPOSTHIJOS=
           <span class="hljs-keyword">UPDATE</span> IPCABMV <span class="hljs-keyword">SET</span> <span class="hljs-keyword">STATUS</span>=<span class="hljs-number">20000</span> <span class="hljs-keyword">WHERE</span> CODMOV=:CODMOV;     
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
</div></code></pre>
<p>Para la tabla <strong>IPCONCEPTODIV</strong> no había la configuración de la división 471. Por lo que fue necesario realizar los INSERT usando de ejemplo la división 023. Se insertaron un total de 37 conceptos.</p>
<p>Ejemplo:</p>
<pre class="hljs"><code><div><span class="hljs-keyword">Insert</span> <span class="hljs-keyword">into</span> IPCONCEPTODIV (CODCONCE,CODDIV,CODCONCEDIV,DESCONCEDIV,TIPOCONCE,TRANSMITIR,INFOCLIEXTRA,CODOPEMODIF,FECMODIF,HORAMODIF,DESCONCEING) <span class="hljs-keyword">values</span> (<span class="hljs-string">'IPDEVLIB+'</span>,<span class="hljs-string">'471'</span>,<span class="hljs-string">'CALIDAD'</span>,<span class="hljs-string">'LIBERACION DE DEVOLUCION'</span>,<span class="hljs-string">'E'</span>,<span class="hljs-string">'N'</span>,<span class="hljs-string">'S'</span>,<span class="hljs-string">'OSIERRA'</span>,<span class="hljs-string">'2460228'</span>,<span class="hljs-string">'12:55:29'</span>,<span class="hljs-string">'RELEASE OF RETURN PRODUCT'</span>);
</div></code></pre>
<div id='id_stock_reconciliation' />
<h4 id="stock-reconciliation">Stock Reconciliation</h4>
<p>Se debe configurar el IFL I2H.INBINVENTORYXXX  (siendo xxx la división correspondiente). Los archivos ya existen se deben modificar para la división requerida.</p>
<p>Para KARO tomamos el IFL de la división 198 como base: <strong>I2H.INBTRAINBINVENTORY198.ifl</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
    BPOSTHIJOS=          
           <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span>  IPSERIEEXP 
           <span class="hljs-keyword">WHERE</span> CODSERIEEXP <span class="hljs-keyword">IN</span> (
           			<span class="hljs-keyword">SELECT</span> SEX.CODSERIEEXP <span class="hljs-keyword">FROM</span> IPCABPE CP, IPSERIEEXP SEX
				<span class="hljs-keyword">WHERE</span> CP.CODSERIEEXP = SEX.CODSERIEEXP <span class="hljs-keyword">AND</span> SEX.STATUS=<span class="hljs-number">15000</span> <span class="hljs-keyword">AND</span> CP.CODDIV <span class="hljs-keyword">IN</span> (<span class="hljs-string">'001'</span>)
                                      				<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> SEX.CODSERIEEXP);
 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
 
BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'INBInventory'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW , CODDIV
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'198'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
 
 
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY=<span class="hljs-keyword">SELECT</span> A1,A2,A3,TO_CHAR(A4) A4,<span class="hljs-keyword">decode</span>(A5,<span class="hljs-string">'677726'</span>,<span class="hljs-string">'10106'</span>,A5) A5,<span class="hljs-keyword">decode</span>(A6,<span class="hljs-string">'677726'</span>,<span class="hljs-string">'10106'</span>,A6) A6,A7,A8,(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> <span class="hljs-keyword">SUM</span>(A9)&lt;<span class="hljs-number">0</span> <span class="hljs-keyword">then</span> <span class="hljs-string">'-'</span>||<span class="hljs-keyword">lpad</span>(<span class="hljs-keyword">SUM</span>(A9)*<span class="hljs-number">-1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>) <span class="hljs-keyword">else</span> <span class="hljs-keyword">lpad</span>(<span class="hljs-keyword">SUM</span>(A9),<span class="hljs-number">8</span>,<span class="hljs-number">0</span>) <span class="hljs-keyword">end</span>)||<span class="hljs-string">'.0000'</span> A9,<span class="hljs-keyword">lpad</span>(<span class="hljs-keyword">SUM</span>(A10),<span class="hljs-number">8</span>,<span class="hljs-number">0</span>)||<span class="hljs-string">'.0000'</span> A10 ,A11,A12,A13,A14,A15,A16,A17 <span class="hljs-keyword">FROM</span> 
(<span class="hljs-keyword">SELECT</span> USERGW A1, <span class="hljs-string">'KKNEES'</span> A2, <span class="hljs-string">'ES'</span> A3, stk.codmat A4, ART.ITEMNAME A5, ART.ITEMNAME A6, STK.CODLOT A7, 
LOT.CADUCI A8,  STK.CANTIDAD A9,   <span class="hljs-number">0</span>  A10 , CON.CODUBI A11,<span class="hljs-string">'ALS'</span> A12,<span class="hljs-string">'01'</span> A13,
(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> STK.SITUACION <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'000000000_'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'RELEASED'</span> 
          <span class="hljs-keyword">WHEN</span> STK.SITUACION=<span class="hljs-string">'0000020000'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'OLDPRICE'</span> 
         <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(STK.SITUACION,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">'3'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'EXPIRED'</span> 
         <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(STK.SITUACION,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">'2'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'EXPIRED'</span> 
         <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(STK.SITUACION,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">'1'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'QCHOLD'</span> 
         <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(STK.SITUACION,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">'2'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'QCHOLD'</span> 
         <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(STK.SITUACION,<span class="hljs-number">7</span>,<span class="hljs-number">1</span>)&lt;&gt;<span class="hljs-string">'0'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'DAMAGED'</span> 
         <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'BLOCKED'</span> <span class="hljs-keyword">END</span>) A14, <span class="hljs-string">''</span> A15  ,<span class="hljs-string">'EACH'</span> A16,<span class="hljs-string">'00000001.0000'</span> A17 <span class="hljs-keyword">FROM</span>  (<span class="hljs-keyword">SELECT</span> CODMAT,CODDIV, CODART, CODLOT,UNIDADESHOST,  SITUACION,CADUCI, 
             CANTIDAD-NVL(CANTEXP,<span class="hljs-number">0</span>) CANTIDAD
        <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">SELECT</span> STK.CODMAT,ART.CODDIV, STK.CODART, STK.CODLOT, <span class="hljs-keyword">SUM</span>(STK.CANTIDAD) CANTIDAD,
                    ART.UNIDADESHOST, <span class="hljs-keyword">DECODE</span>(<span class="hljs-keyword">SUBSTR</span>(STK.BLOQUEOS,<span class="hljs-number">6</span>,<span class="hljs-number">1</span>),<span class="hljs-string">'0'</span>,<span class="hljs-string">'A'</span>,<span class="hljs-string">'D'</span>) ESTADO,
                    STK.BLOQUEOS SITUACION,LOT.CADUCI
               <span class="hljs-keyword">FROM</span> IPARTIC ART, IPSTOCK STK,IPLOTES LOT
              <span class="hljs-keyword">WHERE</span> ART.CODART=STK.CODART <span class="hljs-keyword">AND</span> ART.CODDIV=:CODDIV <span class="hljs-keyword">AND</span> 
                     <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span>(<span class="hljs-keyword">SELECT</span> STK2.POSSTK 
                        <span class="hljs-keyword">FROM</span> IPSTOCK STK2, IPCONTE CNT
                       <span class="hljs-keyword">WHERE</span> STK2.CODBULTO <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">AND</span> CNT.CODUBI=<span class="hljs-string">'EXP'</span> <span class="hljs-keyword">AND</span> CNT.CODMAT=STK2.CODMAT <span class="hljs-keyword">AND</span> STK2.POSSTK=STK.POSSTK) <span class="hljs-keyword">AND</span>
                    STK.CODART=LOT.CODART <span class="hljs-keyword">AND</span> STK.CODLOT=LOT.CODLOT
           <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> STK.CODMAT,ART.CODDIV, STK.CODART, STK.CODLOT,
                    ART.UNIDADESHOST, <span class="hljs-keyword">DECODE</span>(<span class="hljs-keyword">SUBSTR</span>(STK.BLOQUEOS,<span class="hljs-number">6</span>,<span class="hljs-number">1</span>),<span class="hljs-string">'0'</span>,<span class="hljs-string">'A'</span>,<span class="hljs-string">'D'</span>),
                    STK.BLOQUEOS,LOT.CADUCI
                    ),
             (<span class="hljs-keyword">SELECT</span> STK.CODMAT MATRICULA,<span class="hljs-keyword">SUM</span>(STK.CANTIDAD) CANTEXP, STK.CODART CODARTEXP, STK.CODLOT CODLOTEXP, STK.BLOQUEOS BLOQUEOSEXP 
                <span class="hljs-keyword">FROM</span> IPSTOCK STK, XIPENVIOPED XEP,IPCABBU CB,IPCONTE CNT
               <span class="hljs-keyword">WHERE</span> XEP.STATUS||<span class="hljs-string">''</span>=<span class="hljs-number">200</span>
                     <span class="hljs-keyword">AND</span> STK.CODBULTO=CB.CODBULTO
                     <span class="hljs-keyword">AND</span> CB.CODDIV=XEP.CODDIV
                     <span class="hljs-keyword">AND</span> CB.CODPED=XEP.CODPED
                     <span class="hljs-keyword">AND</span> CB.ANOPED=XEP.ANOPED
                     <span class="hljs-keyword">AND</span> CB.SEQPED=XEP.SEQPED
                     <span class="hljs-keyword">AND</span> STK.CODMAT=CNT.CODMAT
                     <span class="hljs-keyword">AND</span> CNT.CODUBI <span class="hljs-keyword">IN</span> (<span class="hljs-string">'EXP'</span>,<span class="hljs-string">'ETIQEXP'</span>)
              <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> STK.CODMAT,STK.CODART,STK.CODLOT,STK.BLOQUEOS)
      <span class="hljs-keyword">WHERE</span> CODARTEXP(+)=CODART <span class="hljs-keyword">AND</span> CODLOTEXP(+)=CODLOT <span class="hljs-keyword">AND</span> BLOQUEOSEXP(+)=SITUACION)  STK, IPARTIC ART, IPDIVIS <span class="hljs-keyword">DIV</span>, IPLOTES LOT, IPCONTE CON 
	  <span class="hljs-keyword">WHERE</span> STK.CODART=ART.CODART <span class="hljs-keyword">AND</span> ART.CODDIV=DIV.CODDIV <span class="hljs-keyword">AND</span> STK.CODART=LOT.CODART <span class="hljs-keyword">AND</span>
STK.CODLOT=LOT.CODLOT  <span class="hljs-keyword">AND</span> CON.CODMAT=STK.CODMAT  <span class="hljs-keyword">AND</span> ART.CODDIV=:CODDIV  <span class="hljs-keyword">AND</span> ART.ITEMNAME <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>)
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,A13,A14,A15,A16,A17  <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> A5,A6;
 
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP, GWINVENTORY,GWINVENTORY);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP, GWINVENTORY,GWINVENTORY);                                               
    EPOSTQUERY 
ENDBLOQUE
</div></code></pre>
<p>En primer lugar, modificamos CODDIV (471 para KARO)</p>
<pre class="hljs"><code><div>BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'INBInventory'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW , CODDIV
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'471'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
</div></code></pre>
<p>A continuación modificamos el campo A2 que corresponde al VENDOR_ID. En nuestro caso es ‘KARES’ Para KARO.</p>
<pre class="hljs"><code><div>BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY=<span class="hljs-keyword">SELECT</span> A1,A2,A3,TO_CHAR(A4) A4,<span class="hljs-keyword">decode</span>(A5,<span class="hljs-string">'677726'</span>,<span class="hljs-string">'10106'</span>,A5) A5,<span class="hljs-keyword">decode</span>(A6,<span class="hljs-string">'677726'</span>,<span class="hljs-string">'10106'</span>,A6) A6,A7,A8,(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> <span class="hljs-keyword">SUM</span>(A9)&lt;<span class="hljs-number">0</span> <span class="hljs-keyword">then</span> <span class="hljs-string">'-'</span>||<span class="hljs-keyword">lpad</span>(<span class="hljs-keyword">SUM</span>(A9)*<span class="hljs-number">-1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>) <span class="hljs-keyword">else</span> <span class="hljs-keyword">lpad</span>(<span class="hljs-keyword">SUM</span>(A9),<span class="hljs-number">8</span>,<span class="hljs-number">0</span>) <span class="hljs-keyword">end</span>)||<span class="hljs-string">'.0000'</span> A9,<span class="hljs-keyword">lpad</span>(<span class="hljs-keyword">SUM</span>(A10),<span class="hljs-number">8</span>,<span class="hljs-number">0</span>)||<span class="hljs-string">'.0000'</span> A10 ,A11,A12,A13,A14,A15,A16,A17 <span class="hljs-keyword">FROM</span> 
(<span class="hljs-keyword">SELECT</span> USERGW A1, <span class="hljs-string">'KARES'</span> A2, 
</div></code></pre>
<p>Se debe garantizar que el <strong>Client_ID</strong> de los patrones de codificación del GATEWAY se encuentre configurado en el maestro de divisiones de IP6: <strong>IPDIVIS.USERGW</strong></p>
<p>El archivo final sería <strong>I2H.INBTRAINBINVENTORY471.ifl</strong> y queda como se muestra a continuación:</p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
    BPOSTHIJOS=          
           <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span>  IPSERIEEXP 
           <span class="hljs-keyword">WHERE</span> CODSERIEEXP <span class="hljs-keyword">IN</span> (
           			<span class="hljs-keyword">SELECT</span> SEX.CODSERIEEXP <span class="hljs-keyword">FROM</span> IPCABPE CP, IPSERIEEXP SEX
				<span class="hljs-keyword">WHERE</span> CP.CODSERIEEXP = SEX.CODSERIEEXP <span class="hljs-keyword">AND</span> SEX.STATUS=<span class="hljs-number">15000</span> <span class="hljs-keyword">AND</span> CP.CODDIV <span class="hljs-keyword">IN</span> (<span class="hljs-string">'001'</span>)
                                      				<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> SEX.CODSERIEEXP);
 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
 
BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'UAT_INB_ES_Inventory'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW , CODDIV
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'471'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
 
 
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY=<span class="hljs-keyword">SELECT</span> A1,A2,A3,TO_CHAR(A4) A4,<span class="hljs-keyword">decode</span>(A5,<span class="hljs-string">'677726'</span>,<span class="hljs-string">'10106'</span>,A5) A5,<span class="hljs-keyword">decode</span>(A6,<span class="hljs-string">'677726'</span>,<span class="hljs-string">'10106'</span>,A6) A6,A7,A8,(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> <span class="hljs-keyword">SUM</span>(A9)&lt;<span class="hljs-number">0</span> <span class="hljs-keyword">then</span> <span class="hljs-string">'-'</span>||<span class="hljs-keyword">lpad</span>(<span class="hljs-keyword">SUM</span>(A9)*<span class="hljs-number">-1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>) <span class="hljs-keyword">else</span> <span class="hljs-keyword">lpad</span>(<span class="hljs-keyword">SUM</span>(A9),<span class="hljs-number">8</span>,<span class="hljs-number">0</span>) <span class="hljs-keyword">end</span>)||<span class="hljs-string">'.0000'</span> A9,<span class="hljs-keyword">lpad</span>(<span class="hljs-keyword">SUM</span>(A10),<span class="hljs-number">8</span>,<span class="hljs-number">0</span>)||<span class="hljs-string">'.0000'</span> A10 ,A11,A12,A13,A14,A15,A16,A17 <span class="hljs-keyword">FROM</span> 
(<span class="hljs-keyword">SELECT</span> USERGW A1, <span class="hljs-string">'KARES'</span> A2, <span class="hljs-string">'ES'</span> A3, stk.codmat A4, NVL(ITEMNAME,CODARTDIV) A5, NVL(ITEMNAME,CODARTDIV) A6, STK.CODLOT A7, 
LOT.CADUCI A8,  STK.CANTIDAD A9,   <span class="hljs-number">0</span>  A10 , CON.CODUBI A11,<span class="hljs-string">'ALS'</span> A12,<span class="hljs-string">'01'</span> A13,
(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> STK.SITUACION <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'000000000_'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'RELEASED'</span> 
          <span class="hljs-keyword">WHEN</span> STK.SITUACION=<span class="hljs-string">'0000020000'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'OLDPRICE'</span> 
         <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(STK.SITUACION,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">'3'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'EXPIRED'</span> 
         <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(STK.SITUACION,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">'2'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'EXPIRED'</span> 
         <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(STK.SITUACION,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">'1'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'QCHOLD'</span> 
         <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(STK.SITUACION,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">'2'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'QCHOLD'</span> 
         <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">SUBSTR</span>(STK.SITUACION,<span class="hljs-number">7</span>,<span class="hljs-number">1</span>)&lt;&gt;<span class="hljs-string">'0'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'DAMAGED'</span> 
         <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'BLOCKED'</span> <span class="hljs-keyword">END</span>) A14, <span class="hljs-string">''</span> A15  ,<span class="hljs-string">'EACH'</span> A16,<span class="hljs-string">'00000001.0000'</span> A17 <span class="hljs-keyword">FROM</span>  (<span class="hljs-keyword">SELECT</span> CODMAT,CODDIV, CODART, CODLOT,UNIDADESHOST,  SITUACION,CADUCI, 
             CANTIDAD-NVL(CANTEXP,<span class="hljs-number">0</span>) CANTIDAD
        <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">SELECT</span> STK.CODMAT,ART.CODDIV, STK.CODART, STK.CODLOT, <span class="hljs-keyword">SUM</span>(STK.CANTIDAD) CANTIDAD,
                    ART.UNIDADESHOST, <span class="hljs-keyword">DECODE</span>(<span class="hljs-keyword">SUBSTR</span>(STK.BLOQUEOS,<span class="hljs-number">6</span>,<span class="hljs-number">1</span>),<span class="hljs-string">'0'</span>,<span class="hljs-string">'A'</span>,<span class="hljs-string">'D'</span>) ESTADO,
                    STK.BLOQUEOS SITUACION,LOT.CADUCI
               <span class="hljs-keyword">FROM</span> IPARTIC ART, IPSTOCK STK,IPLOTES LOT
              <span class="hljs-keyword">WHERE</span> ART.CODART=STK.CODART <span class="hljs-keyword">AND</span> ART.CODDIV=:CODDIV <span class="hljs-keyword">AND</span> 
                     <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span>(<span class="hljs-keyword">SELECT</span> STK2.POSSTK 
                        <span class="hljs-keyword">FROM</span> IPSTOCK STK2, IPCONTE CNT
                       <span class="hljs-keyword">WHERE</span> STK2.CODBULTO <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">AND</span> CNT.CODUBI=<span class="hljs-string">'EXP'</span> <span class="hljs-keyword">AND</span> CNT.CODMAT=STK2.CODMAT <span class="hljs-keyword">AND</span> STK2.POSSTK=STK.POSSTK) <span class="hljs-keyword">AND</span>
                    STK.CODART=LOT.CODART <span class="hljs-keyword">AND</span> STK.CODLOT=LOT.CODLOT
           <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> STK.CODMAT,ART.CODDIV, STK.CODART, STK.CODLOT,
                    ART.UNIDADESHOST, <span class="hljs-keyword">DECODE</span>(<span class="hljs-keyword">SUBSTR</span>(STK.BLOQUEOS,<span class="hljs-number">6</span>,<span class="hljs-number">1</span>),<span class="hljs-string">'0'</span>,<span class="hljs-string">'A'</span>,<span class="hljs-string">'D'</span>),
                    STK.BLOQUEOS,LOT.CADUCI
                    ),
             (<span class="hljs-keyword">SELECT</span> STK.CODMAT MATRICULA,<span class="hljs-keyword">SUM</span>(STK.CANTIDAD) CANTEXP, STK.CODART CODARTEXP, STK.CODLOT CODLOTEXP, STK.BLOQUEOS BLOQUEOSEXP 
                <span class="hljs-keyword">FROM</span> IPSTOCK STK, XIPENVIOPED XEP,IPCABBU CB,IPCONTE CNT
               <span class="hljs-keyword">WHERE</span> XEP.STATUS||<span class="hljs-string">''</span>=<span class="hljs-number">200</span>
                     <span class="hljs-keyword">AND</span> STK.CODBULTO=CB.CODBULTO
                     <span class="hljs-keyword">AND</span> CB.CODDIV=XEP.CODDIV
                     <span class="hljs-keyword">AND</span> CB.CODPED=XEP.CODPED
                     <span class="hljs-keyword">AND</span> CB.ANOPED=XEP.ANOPED
                     <span class="hljs-keyword">AND</span> CB.SEQPED=XEP.SEQPED
                     <span class="hljs-keyword">AND</span> STK.CODMAT=CNT.CODMAT
                     <span class="hljs-keyword">AND</span> CNT.CODUBI <span class="hljs-keyword">IN</span> (<span class="hljs-string">'EXP'</span>,<span class="hljs-string">'ETIQEXP'</span>)
              <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> STK.CODMAT,STK.CODART,STK.CODLOT,STK.BLOQUEOS)
      <span class="hljs-keyword">WHERE</span> CODARTEXP(+)=CODART <span class="hljs-keyword">AND</span> CODLOTEXP(+)=CODLOT <span class="hljs-keyword">AND</span> BLOQUEOSEXP(+)=SITUACION)  STK, IPARTIC ART, IPDIVIS <span class="hljs-keyword">DIV</span>, IPLOTES LOT, IPCONTE CON 
	  <span class="hljs-keyword">WHERE</span> STK.CODART=ART.CODART <span class="hljs-keyword">AND</span> ART.CODDIV=DIV.CODDIV <span class="hljs-keyword">AND</span> STK.CODART=LOT.CODART <span class="hljs-keyword">AND</span>
STK.CODLOT=LOT.CODLOT  <span class="hljs-keyword">AND</span> CON.CODMAT=STK.CODMAT  <span class="hljs-keyword">AND</span> ART.CODDIV=:CODDIV)
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,A13,A14,A15,A16,A17  <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> A5,A6;
 
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP, GWINVENTORY,GWINVENTORY);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP, GWINVENTORY,GWINVENTORY);                                               
    EPOSTQUERY 
ENDBLOQUE
</div></code></pre>
<div id='id_invoices' />
<h4 id="invoices">Invoices</h4>
<p>Se debe configurar el IFL I2H.INBINVOICExxx (siendo xxx la división correspondiente). Los archivos ya existen, se deben modificar para la división requerida.</p>
<p>Para KARO tomamos el IFL de la división 198 como base <strong>I2H.INBINVOICE198.ifl</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
    BPOSTHIJOS=          
<span class="hljs-comment">#          UPDATE IPSERIEEXP SET status=20000,CODOPEMODIF='CABLINEXP001',HORAMODIF=HORASYS,FECMODIF=FECHASYS  </span>
           <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
 
BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'INBInvoice'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
				 USERGW,CODDIV 
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'198'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
 
 
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> :USERGW A1, <span class="hljs-string">'KKNEES'</span> A2, <span class="hljs-string">'ES'</span> A3, CP.CODPED A4,  CP.CODALB A5, 
           to_char(CP.SEQLINORIG) A6,   to_char(CP.SEQLINORIG) A7, <span class="hljs-string">'ES'</span>||<span class="hljs-keyword">DECODE</span>(seriefact,<span class="hljs-string">'ABO'</span>,<span class="hljs-string">'DEV'</span>,SERIEFACT)||to_char(CP.CONTFAC) A8,TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECFACTURA,<span class="hljs-string">'J'</span>),<span class="hljs-string">'YYYYMMDD'</span>) A9,
           (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">replace</span>(CLIKYOWA,<span class="hljs-string">'A'</span>,<span class="hljs-string">''</span>)  <span class="hljs-keyword">FROM</span> ZIPDESTINAT <span class="hljs-keyword">WHERE</span> (NUMCLIENTE=NVL(CODCLI,CODCLIREEXP) <span class="hljs-keyword">OR</span> CODCLI=<span class="hljs-keyword">DECODE</span>(<span class="hljs-keyword">SUBSTR</span>(CLIKYOWA,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>),<span class="hljs-string">'A'</span>,<span class="hljs-keyword">SUBSTR</span>(CLIKYOWA,<span class="hljs-number">2</span>,<span class="hljs-number">999</span>),CLIKYOWA)) <span class="hljs-keyword">AND</span> <span class="hljs-keyword">ROWNUM</span>=<span class="hljs-number">1</span>) A10, CP.CODCLIREEXP A11, CP.DESCLI A12, CP.DIRECCION A13,CP.DIRECCION1 A14,
       CP.POBLACION A15, <span class="hljs-string">'ES'</span> A16, 
        CP.DP A17, NIFREEXP  A18, <span class="hljs-keyword">trim</span>(to_char(CP.DCTO,<span class="hljs-string">'00000000.0000'</span>)) A19,<span class="hljs-keyword">trim</span>(to_char(((BASE_LIN_SIN_DCTO_SOBI-BASE_LIN_CON_DCTO_SOBI)),<span class="hljs-string">'00000000.0000'</span>)) A20,<span class="hljs-keyword">trim</span>(to_char(LPIVA,<span class="hljs-string">'00000000.0000'</span>)) A21,
        (<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'E'</span>||<span class="hljs-keyword">replace</span>(CLIKYOWA,<span class="hljs-string">'A'</span>,<span class="hljs-string">''</span>)  <span class="hljs-keyword">FROM</span> ZIPDESTINAT <span class="hljs-keyword">WHERE</span> (NUMCLIENTE=NVL(CODCLI,CODCLIREEXP) <span class="hljs-keyword">OR</span> CODCLI=<span class="hljs-keyword">DECODE</span>(<span class="hljs-keyword">SUBSTR</span>(CLIKYOWA,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>),<span class="hljs-string">'A'</span>,<span class="hljs-keyword">SUBSTR</span>(CLIKYOWA,<span class="hljs-number">2</span>,<span class="hljs-number">999</span>),CLIKYOWA)) <span class="hljs-keyword">AND</span> <span class="hljs-keyword">ROWNUM</span>=<span class="hljs-number">1</span>) A22,  CP.CODCLI A23,
        CP.DESCLIREEXP A24, CP.DIRREEXP A25, CP.DIRREEXP1 A26, CP.POBREEXP A27, <span class="hljs-string">'ES'</span> A28, CP.DPREEXP A29, TELEFONO A30, <span class="hljs-string">''</span> A31, ITEMNAME A32, ITEMNAME A33, DESART A34, 
        <span class="hljs-keyword">trim</span>(to_char(CANTPEDIDA,<span class="hljs-string">'00000000.0000'</span>))  A35,
         <span class="hljs-keyword">trim</span>(to_char(<span class="hljs-keyword">SUM</span>(CANTSERVIDA),<span class="hljs-string">'00000000.0000'</span>))  A36, <span class="hljs-string">'EACH'</span> A37, <span class="hljs-string">'00000001.0000'</span> A38, <span class="hljs-keyword">trim</span>(to_char(<span class="hljs-keyword">sum</span>((importe_lin_con_dcto)),<span class="hljs-string">'00000000.0000'</span>))  A39, 
         <span class="hljs-keyword">trim</span>(to_char(<span class="hljs-keyword">sum</span>((importe_iva_final+importe_recargo_final)),<span class="hljs-string">'00000000.0000'</span>))  A40, LPIVA||<span class="hljs-string">'%'</span> A41, <span class="hljs-keyword">trim</span>(to_char(CP.PRECIOUNI,<span class="hljs-string">'00000000.0000'</span>))  A42, 
         TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECRECEP,<span class="hljs-string">'J'</span>),<span class="hljs-string">'YYYYMMDD'</span>) A43,<span class="hljs-keyword">DECODE</span>(CP.TIPOPED,<span class="hljs-string">'VENTA'</span>,<span class="hljs-string">'SALE'</span>,<span class="hljs-string">'ABONO'</span>,<span class="hljs-string">'VCRED'</span>,<span class="hljs-string">'ABOESP'</span>,<span class="hljs-string">'VCRED'</span>,<span class="hljs-string">'FI'</span>,<span class="hljs-string">'VDEB'</span>,<span class="hljs-string">'FIESP'</span>,<span class="hljs-string">'VDEB'</span>,<span class="hljs-string">'SINCARGO'</span>,<span class="hljs-string">'SHIP'</span>,<span class="hljs-string">'DEPOSITO'</span>,<span class="hljs-string">'SHIP'</span>,<span class="hljs-string">'SALES'</span>) A44,
          <span class="hljs-string">''</span> A45,<span class="hljs-string">''</span> A46, <span class="hljs-string">''</span> A47, <span class="hljs-keyword">DECODE</span>(CODLOT,<span class="hljs-literal">NULL</span>,<span class="hljs-string">'SINLOTE'</span>,CODLOT) A48,  <span class="hljs-keyword">DECODE</span>(CADUCI,<span class="hljs-literal">NULL</span>,<span class="hljs-string">'20301231'</span>,CADUCI) A49,
         <span class="hljs-string">'EUR'</span> A50, <span class="hljs-string">'Hospitals - National'</span> A51,<span class="hljs-string">''</span> A52, <span class="hljs-string">''</span> A53, <span class="hljs-string">''</span> A54,<span class="hljs-string">''</span> A55, <span class="hljs-keyword">trim</span>(to_char(lprecargo,<span class="hljs-string">'00000000.0000'</span>)) A56, <span class="hljs-string">''</span> A57, <span class="hljs-string">''</span> A58, <span class="hljs-string">''</span> A59, <span class="hljs-string">''</span> A60,
         <span class="hljs-string">''</span> A61,<span class="hljs-string">''</span> A62, <span class="hljs-string">''</span> A63, <span class="hljs-string">''</span> A64,<span class="hljs-string">''</span> A65,<span class="hljs-string">''</span> A66,<span class="hljs-string">''</span> A67, <span class="hljs-string">''</span> A68,<span class="hljs-string">''</span> A69, <span class="hljs-string">''</span> A70, <span class="hljs-string">''</span> A71, <span class="hljs-string">''</span> A72, <span class="hljs-string">''</span> A73, <span class="hljs-string">''</span> A74,CP.CODPED, CP.CODDIV, CP.ANOPED, CP.SEQPED 
             <span class="hljs-keyword">FROM</span> IPV_BASEPED CP, 
            ipartic ART,  IPDIVIS <span class="hljs-keyword">DIV</span> ,  XIPCABPE XCP
            <span class="hljs-keyword">WHERE</span> CP.CODDIV=:CODDIV    <span class="hljs-keyword">AND</span> CP.CODDIV=DIV.CODDIV  
                  <span class="hljs-keyword">AND</span> ART.CODART=CP.CODART  <span class="hljs-keyword">AND</span> CP.CONTFAC+<span class="hljs-number">0</span>&gt;<span class="hljs-number">0</span> 
                   <span class="hljs-keyword">AND</span> <span class="hljs-keyword">SUBSTR</span>(CP.CODPED,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)&lt;&gt;<span class="hljs-string">'AG'</span>  <span class="hljs-keyword">AND</span> XCP.CODDIV=CP.CODDIV 
                <span class="hljs-keyword">AND</span> XCP.ANOPED=CP.ANOPED 
                <span class="hljs-keyword">AND</span> XCP.CODPED=CP.CODPED 
                <span class="hljs-keyword">AND</span> XCP.SEQPED=CP.SEQPED <span class="hljs-keyword">AND</span> COMPICKPACK=<span class="hljs-string">'N'</span> <span class="hljs-keyword">AND</span> CP.FECRECEP&gt;=FECHASYS<span class="hljs-number">-270</span> 
                <span class="hljs-keyword">AND</span> CP.FECFACTURA <span class="hljs-keyword">BETWEEN</span> FECHASYS<span class="hljs-number">-270</span> <span class="hljs-keyword">AND</span> FECHASYS  
                  <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> DIV.DABDIV, CP.CODDIV,  CODARTDIV,   ITEMNAME, BASE_LIN_SIN_DCTO_SOBI,BASE_LIN_CON_DCTO_SOBI,   
       CADUCI,CP.CODPED, CP.CODALB,CP.SEQLINORIG, <span class="hljs-keyword">SYSDATE</span>,CP.CODDIV,CP. CODPED,CP. ANOPED,CP.SEQPED  ,CP.SEQLINORIG,CP.CONTFAC,CP.FECTERMIN,seriefact,CP.TIPOPED,
       codcliREEXP ,  CANTPEDIDA,CP.PRECIOUNI,lpiva,CP.FECRECEP,CODLOT,FECFACTURA,DESCLIREEXP,DIRREEXP,DIRREEXP1,POBREEXP,DPREEXP,NIFREEXP,CP.CODCLI,CP.DIRECCION,CP.DIRECCION,CP.DIRECCION1,CP.POBLACION,CP.DP,
       CP.DCTO  ,LPIVA,lprecargo ,codcliREEXP, CP.DESCLI , CP.DIRECCION, CP.DIRECCION1 , CP.poblacion,  CP.DP , TELEFONO, DESART <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> CP.CONTFAC,CP.SEQLINORIG;
 
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP, GWINVOICE,GWINVOICE);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP, GWINVOICE,GWINVOICE);                                               
    EPOSTQUERY 
    BPOSTHIJOS=
	  <span class="hljs-keyword">UPDATE</span>  XIPCABPE  
          <span class="hljs-keyword">SET</span> COMPICKPACK=<span class="hljs-string">'S'</span>,CODOPEMODIF=<span class="hljs-string">'INVOICE'</span>,HORAMODIF=HORASYS, FECMODIF=FECHASYS  
          <span class="hljs-keyword">WHERE</span> CODPED=:CODPED 
          <span class="hljs-keyword">AND</span> CODDIV=:CODDIV 
          <span class="hljs-keyword">AND</span> SEQPED=:SEQPED 
          <span class="hljs-keyword">AND</span> ANOPED=:ANOPED 
          <span class="hljs-keyword">AND</span> COMPICKPACK=<span class="hljs-string">'N'</span>; 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
</div></code></pre>
<p>En primer lugar, modificamos CODDIV (471 para KARO)</p>
<pre class="hljs"><code><div>BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'INBInvoice'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
				 USERGW,CODDIV 
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'471'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
</div></code></pre>
<p>A continuación modificamos el campo A2 que corresponde al VENDOR_ID. En nuestro caso es ‘KARES’ Para KARO.</p>
<pre class="hljs"><code><div>BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> :USERGW A1, <span class="hljs-string">'KARES'</span> A2...
</div></code></pre>
<p>Se debe garantizar que el Client_ID de los patrones de codificación del GATEWAY se encuentre configurado en el maestro de divisiones de IP6: <strong>IPDIVIS.USERGW</strong></p>
<p>El archivo final sería <strong>I2H.INBINVOICE471.ifl</strong> y queda como se muestra a continuación:</p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
    BPOSTHIJOS=          
<span class="hljs-comment">#          UPDATE IPSERIEEXP SET status=20000,CODOPEMODIF='CABLINEXP001',HORAMODIF=HORASYS,FECMODIF=FECHASYS  </span>
           <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
 
BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'UAT_INB_ES_Invoice'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
				 USERGW,CODDIV 
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> DIV.CODDIV=<span class="hljs-string">'471'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
 
 
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> :USERGW A1, <span class="hljs-string">'KARES'</span> A2, <span class="hljs-string">'ES'</span> A3, CP.CODPED A4,  CP.CODALB A5, 
           to_char(CP.SEQLINORIG) A6,   to_char(CP.SEQLINORIG) A7, <span class="hljs-string">'ES'</span>||<span class="hljs-keyword">DECODE</span>(seriefact,<span class="hljs-string">'ABO'</span>,<span class="hljs-string">'DEV'</span>,SERIEFACT)||to_char(CP.CONTFAC) A8,TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECFACTURA,<span class="hljs-string">'J'</span>),<span class="hljs-string">'YYYYMMDD'</span>) A9,
           (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">replace</span>(CLIKYOWA,<span class="hljs-string">'A'</span>,<span class="hljs-string">''</span>)  <span class="hljs-keyword">FROM</span> ZIPDESTINAT <span class="hljs-keyword">WHERE</span> (NUMCLIENTE=NVL(CODCLI,CODCLIREEXP) <span class="hljs-keyword">OR</span> CODCLI=<span class="hljs-keyword">DECODE</span>(<span class="hljs-keyword">SUBSTR</span>(CLIKYOWA,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>),<span class="hljs-string">'A'</span>,<span class="hljs-keyword">SUBSTR</span>(CLIKYOWA,<span class="hljs-number">2</span>,<span class="hljs-number">999</span>),CLIKYOWA)) <span class="hljs-keyword">AND</span> <span class="hljs-keyword">ROWNUM</span>=<span class="hljs-number">1</span>) A10, CP.CODCLIREEXP A11, CP.DESCLI A12, CP.DIRECCION A13,CP.DIRECCION1 A14,
       CP.POBLACION A15, <span class="hljs-string">'ES'</span> A16, 
        CP.DP A17, NIFREEXP  A18, <span class="hljs-keyword">trim</span>(to_char(CP.DCTO,<span class="hljs-string">'00000000.0000'</span>)) A19,<span class="hljs-keyword">trim</span>(to_char(((BASE_LIN_SIN_DCTO_SOBI-BASE_LIN_CON_DCTO_SOBI)),<span class="hljs-string">'00000000.0000'</span>)) A20,<span class="hljs-keyword">trim</span>(to_char(LPIVA,<span class="hljs-string">'00000000.0000'</span>)) A21,
        (<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'E'</span>||<span class="hljs-keyword">replace</span>(CLIKYOWA,<span class="hljs-string">'A'</span>,<span class="hljs-string">''</span>)  <span class="hljs-keyword">FROM</span> ZIPDESTINAT <span class="hljs-keyword">WHERE</span> (NUMCLIENTE=NVL(CODCLI,CODCLIREEXP) <span class="hljs-keyword">OR</span> CODCLI=<span class="hljs-keyword">DECODE</span>(<span class="hljs-keyword">SUBSTR</span>(CLIKYOWA,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>),<span class="hljs-string">'A'</span>,<span class="hljs-keyword">SUBSTR</span>(CLIKYOWA,<span class="hljs-number">2</span>,<span class="hljs-number">999</span>),CLIKYOWA)) <span class="hljs-keyword">AND</span> <span class="hljs-keyword">ROWNUM</span>=<span class="hljs-number">1</span>) A22,  CP.CODCLI A23,
        CP.DESCLIREEXP A24, CP.DIRREEXP A25, CP.DIRREEXP1 A26, CP.POBREEXP A27, <span class="hljs-string">'ES'</span> A28, CP.DPREEXP A29, TELEFONO A30, <span class="hljs-string">''</span> A31, ART.CODART A32, NVL(ART.CODARTDIV,ART.CODART) A33, DESART A34, 
        <span class="hljs-keyword">trim</span>(to_char(CANTPEDIDA,<span class="hljs-string">'00000000.0000'</span>))  A35,
         <span class="hljs-keyword">trim</span>(to_char(<span class="hljs-keyword">SUM</span>(CANTSERVIDA),<span class="hljs-string">'00000000.0000'</span>))  A36, <span class="hljs-string">'EACH'</span> A37, <span class="hljs-string">'00000001.0000'</span> A38, <span class="hljs-keyword">trim</span>(to_char(<span class="hljs-keyword">sum</span>((importe_lin_con_dcto)),<span class="hljs-string">'00000000.0000'</span>))  A39, 
         <span class="hljs-keyword">trim</span>(to_char(<span class="hljs-keyword">sum</span>((importe_iva_final+importe_recargo_final)),<span class="hljs-string">'00000000.0000'</span>))  A40, LPIVA||<span class="hljs-string">'%'</span> A41, <span class="hljs-keyword">trim</span>(to_char(CP.PRECIOUNI,<span class="hljs-string">'00000000.0000'</span>))  A42, 
         TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECRECEP,<span class="hljs-string">'J'</span>),<span class="hljs-string">'YYYYMMDD'</span>) A43,<span class="hljs-keyword">DECODE</span>(CP.TIPOPED,<span class="hljs-string">'VENTA'</span>,<span class="hljs-string">'SALE'</span>,<span class="hljs-string">'ABONO'</span>,<span class="hljs-string">'VCRED'</span>,<span class="hljs-string">'ABOESP'</span>,<span class="hljs-string">'VCRED'</span>,<span class="hljs-string">'FI'</span>,<span class="hljs-string">'VDEB'</span>,<span class="hljs-string">'FIESP'</span>,<span class="hljs-string">'VDEB'</span>,<span class="hljs-string">'SINCARGO'</span>,<span class="hljs-string">'SHIP'</span>,<span class="hljs-string">'DEPOSITO'</span>,<span class="hljs-string">'SHIP'</span>,<span class="hljs-string">'SALES'</span>) A44,
          <span class="hljs-string">''</span> A45,<span class="hljs-string">''</span> A46, <span class="hljs-string">''</span> A47, <span class="hljs-keyword">DECODE</span>(CODLOT,<span class="hljs-literal">NULL</span>,<span class="hljs-string">'SINLOTE'</span>,CODLOT) A48,  <span class="hljs-keyword">DECODE</span>(CADUCI,<span class="hljs-literal">NULL</span>,<span class="hljs-string">'20301231'</span>,CADUCI) A49,
         <span class="hljs-string">'EUR'</span> A50, <span class="hljs-string">'Hospitals - National'</span> A51,<span class="hljs-string">''</span> A52, <span class="hljs-string">''</span> A53, <span class="hljs-string">''</span> A54,<span class="hljs-string">''</span> A55, <span class="hljs-keyword">trim</span>(to_char(lprecargo,<span class="hljs-string">'00000000.0000'</span>)) A56, <span class="hljs-string">''</span> A57, <span class="hljs-string">''</span> A58, <span class="hljs-string">''</span> A59, <span class="hljs-string">''</span> A60,
         <span class="hljs-string">''</span> A61,<span class="hljs-string">''</span> A62, <span class="hljs-string">''</span> A63, <span class="hljs-string">''</span> A64,<span class="hljs-string">''</span> A65,<span class="hljs-string">''</span> A66,<span class="hljs-string">''</span> A67, <span class="hljs-string">''</span> A68,<span class="hljs-string">''</span> A69, <span class="hljs-string">''</span> A70, <span class="hljs-string">''</span> A71, <span class="hljs-string">''</span> A72, <span class="hljs-string">''</span> A73, <span class="hljs-string">''</span> A74,CP.CODPED, CP.CODDIV, CP.ANOPED, CP.SEQPED 
             <span class="hljs-keyword">FROM</span> IPV_BASEPED CP, 
            ipartic ART,  IPDIVIS <span class="hljs-keyword">DIV</span> ,  XIPCABPE XCP
            <span class="hljs-keyword">WHERE</span> CP.CODDIV=:CODDIV    <span class="hljs-keyword">AND</span> CP.CODDIV=DIV.CODDIV  
                  <span class="hljs-keyword">AND</span> ART.CODART=CP.CODART  <span class="hljs-keyword">AND</span> CP.CONTFAC+<span class="hljs-number">0</span>&gt;<span class="hljs-number">0</span> 
                   <span class="hljs-keyword">AND</span> <span class="hljs-keyword">SUBSTR</span>(CP.CODPED,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)&lt;&gt;<span class="hljs-string">'AG'</span>  <span class="hljs-keyword">AND</span> XCP.CODDIV=CP.CODDIV 
                <span class="hljs-keyword">AND</span> XCP.ANOPED=CP.ANOPED 
                <span class="hljs-keyword">AND</span> XCP.CODPED=CP.CODPED 
                <span class="hljs-keyword">AND</span> XCP.SEQPED=CP.SEQPED <span class="hljs-keyword">AND</span> COMPICKPACK=<span class="hljs-string">'N'</span> <span class="hljs-keyword">AND</span> CP.FECRECEP&gt;=FECHASYS<span class="hljs-number">-270</span> 
                <span class="hljs-keyword">AND</span> CP.FECFACTURA <span class="hljs-keyword">BETWEEN</span> FECHASYS<span class="hljs-number">-270</span> <span class="hljs-keyword">AND</span> FECHASYS  
                  <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> DIV.DABDIV, CP.CODDIV,  CODARTDIV,   ART.CODART, BASE_LIN_SIN_DCTO_SOBI,BASE_LIN_CON_DCTO_SOBI,   
       CADUCI,CP.CODPED, CP.CODALB,CP.SEQLINORIG, <span class="hljs-keyword">SYSDATE</span>,CP.CODDIV,CP. CODPED,CP. ANOPED,CP.SEQPED  ,CP.SEQLINORIG,CP.CONTFAC,CP.FECTERMIN,seriefact,CP.TIPOPED,
       codcliREEXP ,  CANTPEDIDA,CP.PRECIOUNI,lpiva,CP.FECRECEP,CODLOT,FECFACTURA,DESCLIREEXP,DIRREEXP,DIRREEXP1,POBREEXP,DPREEXP,NIFREEXP,CP.CODCLI,CP.DIRECCION,CP.DIRECCION,CP.DIRECCION1,CP.POBLACION,CP.DP,
       CP.DCTO  ,LPIVA,lprecargo ,codcliREEXP, CP.DESCLI , CP.DIRECCION, CP.DIRECCION1 , CP.poblacion,  CP.DP , TELEFONO, DESART <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> CP.CONTFAC,CP.SEQLINORIG;
 
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP, GWINVOICE,GWINVOICE);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP, GWINVOICE,GWINVOICE);                                               
    EPOSTQUERY 
    BPOSTHIJOS=
	  <span class="hljs-keyword">UPDATE</span>  XIPCABPE  
          <span class="hljs-keyword">SET</span> COMPICKPACK=<span class="hljs-string">'S'</span>,CODOPEMODIF=<span class="hljs-string">'INVOICE'</span>,HORAMODIF=HORASYS, FECMODIF=FECHASYS  
          <span class="hljs-keyword">WHERE</span> CODPED=:CODPED 
          <span class="hljs-keyword">AND</span> CODDIV=:CODDIV 
          <span class="hljs-keyword">AND</span> SEQPED=:SEQPED 
          <span class="hljs-keyword">AND</span> ANOPED=:ANOPED 
          <span class="hljs-keyword">AND</span> COMPICKPACK=<span class="hljs-string">'N'</span>; 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
</div></code></pre>
<div id= 'id_payments' />
<h4 id="payments-cash-receipt">Payments (cash receipt)</h4>
<p>Preguntado a comercial si es para hacer o no. Los cobros no están en IP6, están en TELNET. Se ha pedido a comercial si esto se puede sacar del scope del proyecto.</p>
<div id ='id_openinvoices' />
<h4 id="openinvoices-aged-balance">OpenInvoices (aged balance)</h4>
<p>Preguntado a comercial si es para hacer o no. Los cobros no están en IP6, están en TELNET. Se ha pedido a comercial si esto se puede sacar del scope del proyecto.</p>
<div id ='id_wip' />
<h4 id="wip-work-in-progreess">WIP (Work In Progreess)</h4>
<p>Se debe configurar el IFL I2H.INBWORKINPROGRESSxxx.IFL (siendo xxx la división correspondiente). Los archivos ya existen, se deben modificar para la división requerida.</p>
<p>Se toma de ejemplo el IFL de la división 202 <strong>I2H.INBWORKINPROGRESS202.IFL</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
    BPOSTHIJOS=          
           <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span>  IPSERIEEXP 
           <span class="hljs-keyword">WHERE</span> CODSERIEEXP <span class="hljs-keyword">IN</span> (
           			<span class="hljs-keyword">SELECT</span> SEX.CODSERIEEXP <span class="hljs-keyword">FROM</span> IPCABPE CP, IPSERIEEXP SEX
				<span class="hljs-keyword">WHERE</span> CP.CODSERIEEXP = SEX.CODSERIEEXP <span class="hljs-keyword">AND</span> SEX.STATUS=<span class="hljs-number">15000</span> <span class="hljs-keyword">AND</span> CP.CODDIV <span class="hljs-keyword">IN</span> (<span class="hljs-string">'001'</span>)
                                      				<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> SEX.CODSERIEEXP);
 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
 
BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'INBWORKINPROGRESS'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW,CODDIV
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> CODDIV=<span class="hljs-string">'202'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
 
 
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> <span class="hljs-string">'REDDY'</span> A1,:USERGW A2, <span class="hljs-string">'ES'</span> A3,CP.CODPED A4,  CP.CODALB A5,   <span class="hljs-string">'Shipped'</span>  A6,  TO_CHAR(LP.SEQLINEA)  A7,  
TO_CHAR(LP.SEQLINORIG) A8, CP.SUPEDIDO A9,
TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECGRABACION,<span class="hljs-string">'J'</span>),<span class="hljs-string">'YYYYMMDD'</span>) A10 , TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.SUFECHA,<span class="hljs-string">'J'</span>),<span class="hljs-string">'YYYYMMDD'</span>) A11 , TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.SUFECHA,<span class="hljs-string">'J'</span>),<span class="hljs-string">'YYYYMMDD'</span>) A12,
TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.SUFECHA,<span class="hljs-string">'J'</span>),<span class="hljs-string">'YYYYMMDD'</span>) A13, art.codartdiv A14, ART.CODARTDIV A15,
<span class="hljs-keyword">LPAD</span>(CANTSERVIDA,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>)||<span class="hljs-string">'.0000'</span> A16 ,<span class="hljs-string">'EACH'</span> A17, 
<span class="hljs-keyword">LPAD</span>(CANTPEDIDA,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>)||<span class="hljs-string">'.0000'</span> A18,<span class="hljs-keyword">TRIM</span>(TO_CHAR(PRECIOUNI,<span class="hljs-string">'00000000.0000'</span>)) A19,<span class="hljs-keyword">TRIM</span>(TO_CHAR(PRECIOUNI,<span class="hljs-string">'00000000.0000'</span>)) A20, 
<span class="hljs-keyword">TRIM</span>(TO_CHAR(PRECIOUNI*CANTSERVIDA,<span class="hljs-string">'00000000.0000'</span>)) A21, CP.CODCLI A22, CP.CODCLI A23, 
CP.DESCLI A24, <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(CP.DIRECCION,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) A25, 
<span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(CP.DIRECCION,<span class="hljs-number">36</span>,<span class="hljs-number">5</span>)|| <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(CP.DIRECCION1,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) ) A26 , 
CP.POBLACION A27,<span class="hljs-string">'ES'</span> A28, CP.DP A29 ,CP.CODCLI A30, CP.CODCLI A31, 
CP.DESCLI A32, <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(CP.DIRECCION,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) A33, 
<span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(CP.DIRECCION,<span class="hljs-number">36</span>,<span class="hljs-number">5</span>)|| <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(CP.DIRECCION1,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) ) A34 , 
CP.POBLACION A35,<span class="hljs-string">'ES'</span> A36, CP.DP A37, CP.TELEFONO A38, <span class="hljs-string">''</span> A39,<span class="hljs-string">'NORMAL'</span> A40,<span class="hljs-string">'00000000.0000'</span> A41, <span class="hljs-string">'EUR'</span> A42,<span class="hljs-string">''</span> A43
             <span class="hljs-keyword">FROM</span> IPCABPE CP, IPAGENC AGE, IPDIVIS <span class="hljs-keyword">DIV</span>,  IPLINPE LP, 
             (<span class="hljs-keyword">SELECT</span> CODART, CODARTDIV, CODDIV <span class="hljs-keyword">FROM</span> IPARTIC <span class="hljs-keyword">WHERE</span> CODDIV <span class="hljs-keyword">IN</span> (:CODDIV)) ART 
            <span class="hljs-keyword">WHERE</span> CP.CODDIV=:CODDIV <span class="hljs-keyword">AND</span> CP.CODPED=LP.CODPED <span class="hljs-keyword">AND</span> CP.ANOPED=LP.ANOPED <span class="hljs-keyword">AND</span> CP.SEQPED= LP.SEQPED <span class="hljs-keyword">AND</span> CP.CODDIV=LP.CODDIV  
                  <span class="hljs-keyword">AND</span> CP.CODDIV=DIV.CODDIV <span class="hljs-keyword">AND</span> ART.CODDIV=CP.CODDIV 
                  <span class="hljs-keyword">AND</span> ART.CODART=LP.CODART||<span class="hljs-string">''</span>
          <span class="hljs-keyword">AND</span> CP.CODAGE=AGE.CODAGE <span class="hljs-keyword">and</span> cp.status <span class="hljs-keyword">between</span> <span class="hljs-number">7000</span> <span class="hljs-keyword">and</span> <span class="hljs-number">11000</span>;
<span class="hljs-comment">#and cp.status&lt;=11000;</span>
 
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP, GWPROGRESS,GWPROGRESS);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP, GWPROGRESS,GWPROGRESS);                                               
    EPOSTQUERY 
    BPOSTHIJOS=
<span class="hljs-comment">#UPDATE XIPCABPE SET COMPICKPACK='S',CODOPEMODIF='PICKPACKSANOFI',HORAMODIF=HORASYS, FECMODIF=FECHASYS</span>
<span class="hljs-comment">#WHERE CODDIV=:CODDIV AND ANOPED=:ANOPED AND CODPED=:CODPED AND SEQPED=:SEQPED;</span>
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
</div></code></pre>
<p>Modificamos CODDIV (471 para KARO)</p>
<pre class="hljs"><code><div>BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'INBWORKINPROGRESS'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW,CODDIV
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> CODDIV=<span class="hljs-string">'471'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
</div></code></pre>
<p>El archivo final sería <strong>I2H.INBWORKINPROGRESS471.IFL</strong> y queda como se muestra a continuación:</p>
<pre class="hljs"><code><div><span class="hljs-comment"># Interfase: I2H.EXPEDSTD.ifl</span>
<span class="hljs-comment"># Función  : interfase de exportación de expediciones (VERSIÓN PARA LA DIVISION 080.)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Creación :  30-06-2005</span>
<span class="hljs-comment"># Autor    :RIK </span>
<span class="hljs-comment">###########################################</span>
<span class="hljs-comment"># Histórico de cambios:</span>
<span class="hljs-comment"># (1) </span>
<span class="hljs-comment">#</span>
 
BEGINBLOQUE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> DUAL;
    BPOSTHIJOS=          
           <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span>  IPSERIEEXP 
           <span class="hljs-keyword">WHERE</span> CODSERIEEXP <span class="hljs-keyword">IN</span> (
           			<span class="hljs-keyword">SELECT</span> SEX.CODSERIEEXP <span class="hljs-keyword">FROM</span> IPCABPE CP, IPSERIEEXP SEX
				<span class="hljs-keyword">WHERE</span> CP.CODSERIEEXP = SEX.CODSERIEEXP <span class="hljs-keyword">AND</span> SEX.STATUS=<span class="hljs-number">15000</span> <span class="hljs-keyword">AND</span> CP.CODDIV <span class="hljs-keyword">IN</span> (<span class="hljs-string">'001'</span>)
                                      				<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> SEX.CODSERIEEXP);
 
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
 
BEGINBLOQUE=DIVISION
PADRE=TODASDIV
    QUERY=<span class="hljs-keyword">SELECT</span> <span class="hljs-string">'INBWORKINPROGRESS'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.tmp'</span> FICCEXP,
                 DIV.CODDIV, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> BUZON, <span class="hljs-string">'I:\ip6datos\interfases\GW\subir'</span> ||<span class="hljs-string">'\BAK'</span> BUZONBAK,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\CEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONCERR,
                 PIECEHASTA(BUZONOUT,<span class="hljs-string">'\'</span>,NUMPIECES(BUZONOUT,<span class="hljs-string">'\'</span>)<span class="hljs-number">-1</span>) || <span class="hljs-string">'\ERRORES'</span> || <span class="hljs-string">'\LEXPERR'</span>||TO_CHAR(<span class="hljs-keyword">SYSDATE</span>,<span class="hljs-string">'YYMMDDHH24MISS'</span>)||<span class="hljs-string">'.ERR'</span> BUZONLERR,
            USERGW,CODDIV
            <span class="hljs-keyword">FROM</span> IPDIVIS <span class="hljs-keyword">DIV</span>  <span class="hljs-keyword">WHERE</span> CODDIV=<span class="hljs-string">'471'</span>;
<span class="hljs-comment">#(1)                       </span>
ENDBLOQUE
 
 
BEGINBLOQUE=CEXP
    ERRORES=:BUZONCERR
    PADRE=DIVISION
    BONERROR=
     	<span class="hljs-keyword">ROLLBACK</span>;
        EXIT;
    EONERROR
 
    QUERY= <span class="hljs-keyword">SELECT</span> :USERGW A1,<span class="hljs-string">'KARES'</span> A2, <span class="hljs-string">'ES'</span> A3,CP.CODPED A4,  CP.CODALB A5,   <span class="hljs-string">'Shipped'</span>  A6,  TO_CHAR(LP.SEQLINEA)  A7,  
TO_CHAR(LP.SEQLINORIG) A8, CP.SUPEDIDO A9,
TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.FECGRABACION,<span class="hljs-string">'J'</span>),<span class="hljs-string">'YYYYMMDD'</span>) A10 , TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.SUFECHA,<span class="hljs-string">'J'</span>),<span class="hljs-string">'YYYYMMDD'</span>) A11 , TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.SUFECHA,<span class="hljs-string">'J'</span>),<span class="hljs-string">'YYYYMMDD'</span>) A12,
TO_CHAR(<span class="hljs-keyword">TO_DATE</span>(CP.SUFECHA,<span class="hljs-string">'J'</span>),<span class="hljs-string">'YYYYMMDD'</span>) A13, art.codartdiv A14, ART.CODARTDIV A15,
<span class="hljs-keyword">LPAD</span>(CANTSERVIDA,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>)||<span class="hljs-string">'.0000'</span> A16 ,<span class="hljs-string">'EACH'</span> A17, 
<span class="hljs-keyword">LPAD</span>(CANTPEDIDA,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>)||<span class="hljs-string">'.0000'</span> A18,<span class="hljs-keyword">TRIM</span>(TO_CHAR(PRECIOUNI,<span class="hljs-string">'00000000.0000'</span>)) A19,<span class="hljs-keyword">TRIM</span>(TO_CHAR(PRECIOUNI,<span class="hljs-string">'00000000.0000'</span>)) A20, 
<span class="hljs-keyword">TRIM</span>(TO_CHAR(PRECIOUNI*CANTSERVIDA,<span class="hljs-string">'00000000.0000'</span>)) A21, CP.CODCLI A22, CP.CODCLI A23, 
CP.DESCLI A24, <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(CP.DIRECCION,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) A25, 
<span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(CP.DIRECCION,<span class="hljs-number">36</span>,<span class="hljs-number">5</span>)|| <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(CP.DIRECCION1,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) ) A26 , 
CP.POBLACION A27,<span class="hljs-string">'ES'</span> A28, CP.DP A29 ,CP.CODCLI A30, CP.CODCLI A31, 
CP.DESCLI A32, <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(CP.DIRECCION,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) A33, 
<span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(CP.DIRECCION,<span class="hljs-number">36</span>,<span class="hljs-number">5</span>)|| <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">SUBSTR</span>(CP.DIRECCION1,<span class="hljs-number">1</span>,<span class="hljs-number">35</span>) ) ) A34 , 
CP.POBLACION A35,<span class="hljs-string">'ES'</span> A36, CP.DP A37, CP.TELEFONO A38, <span class="hljs-string">''</span> A39,<span class="hljs-string">'NORMAL'</span> A40,<span class="hljs-string">'00000000.0000'</span> A41, <span class="hljs-string">'EUR'</span> A42,<span class="hljs-string">''</span> A43
             <span class="hljs-keyword">FROM</span> IPCABPE CP, IPAGENC AGE, IPDIVIS <span class="hljs-keyword">DIV</span>,  IPLINPE LP, 
             (<span class="hljs-keyword">SELECT</span> CODART, CODARTDIV, CODDIV <span class="hljs-keyword">FROM</span> IPARTIC <span class="hljs-keyword">WHERE</span> CODDIV <span class="hljs-keyword">IN</span> (:CODDIV)) ART 
            <span class="hljs-keyword">WHERE</span> CP.CODDIV=:CODDIV <span class="hljs-keyword">AND</span> CP.CODPED=LP.CODPED <span class="hljs-keyword">AND</span> CP.ANOPED=LP.ANOPED <span class="hljs-keyword">AND</span> CP.SEQPED= LP.SEQPED <span class="hljs-keyword">AND</span> CP.CODDIV=LP.CODDIV  
                  <span class="hljs-keyword">AND</span> CP.CODDIV=DIV.CODDIV <span class="hljs-keyword">AND</span> ART.CODDIV=CP.CODDIV 
                  <span class="hljs-keyword">AND</span> ART.CODART=LP.CODART||<span class="hljs-string">''</span>
          <span class="hljs-keyword">AND</span> CP.CODAGE=AGE.CODAGE <span class="hljs-keyword">and</span> cp.status <span class="hljs-keyword">between</span> <span class="hljs-number">7000</span> <span class="hljs-keyword">and</span> <span class="hljs-number">11000</span>;
 
    BPOSTQUERY= 

 
           ESCRIBEFICHERO(:BUZON,:FICCEXP, GWPROGRESS,GWPROGRESS);
           ESCRIBEFICHERO(:BUZONBAK,:FICCEXP, GWPROGRESS,GWPROGRESS);                                               
    EPOSTQUERY 
    BPOSTHIJOS=
<span class="hljs-comment">#UPDATE XIPCABPE SET COMPICKPACK='S',CODOPEMODIF='PICKPACKSANOFI',HORAMODIF=HORASYS, FECMODIF=FECHASYS</span>
<span class="hljs-comment">#WHERE CODDIV=:CODDIV AND ANOPED=:ANOPED AND CODPED=:CODPED AND SEQPED=:SEQPED;</span>
           <span class="hljs-keyword">COMMIT</span>;
    EPOSTHIJOS
ENDBLOQUE
</div></code></pre>

</body>
</html>
